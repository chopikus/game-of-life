
<!-- saved from url=(0047)https://johnhw.github.io/hashlife/index.md.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=600, initial-scale=1"><style>body{max-width:680px;margin:auto;padding:20px;text-align:justify;line-height:140%;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-smoothing:antialiased;color:#222;font-family:Palatino,Georgia,"Times New Roman",serif}</style><style>@media print{*{-webkit-print-color-adjust:exact;text-shadow:none !important}}body{counter-reset: h1 paragraph line item list-item}@page{margin:0;size:auto}#mdContextMenu{position:absolute;background:#383838;cursor:default;border:1px solid #999;color:#fff;padding:4px 0px;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,"Helvetica Neue",sans-serif;font-size:85%;font-weight:600;border-radius:4px;box-shadow:0px 3px 10px rgba(0,0,0,35%)}#mdContextMenu div{padding:0px 20px}#mdContextMenu div:hover{background:#1659d1}.md code,.md pre{font-family:Menlo,Consolas,monospace;font-size:85%;text-align:left;line-height:140%}.md .mediumToc code,.md longToc code,.md .shortToc code,.md h1 code,.md h2 code,.md h3 code,.md h4 code,.md h5 code,.md h6 code{font-size:unset}.md div.title{font-size:26px;font-weight:800;line-height:120%;text-align:center}.md div.afterTitles{height:10px}.md div.subtitle{text-align:center}.md iframe.textinsert, .md object.textinsert,.md iframe:not(.markdeep){display:block;margin-top:10px;margin-bottom:10px;width:100%;height:75vh;border:1px solid #000;border-radius:4px;background:#f5f5f4}.md .image{display:inline-block}.md img{max-width:100%;page-break-inside:avoid}.md li{text-align:left;text-indent:0}.md pre.listing {width:100%;tab-size:4;-moz-tab-size:4;-o-tab-size:4;counter-reset:line;overflow-x:auto;resize:horizontal}.md pre.listing .linenumbers span.line:before{width:30px;margin-left:-28px;font-size:80%;text-align:right;counter-increment:line;content:counter(line);display:inline-block;padding-right:13px;margin-right:8px;color:#ccc}.md div.tilde{margin:20px 0 -10px;text-align:center}.md .imagecaption,.md .tablecaption,.md .listingcaption{display:inline-block;margin:7px 5px 12px;text-align:justify;font-style:italic}.md img.pixel{image-rendering:-moz-crisp-edges;image-rendering:pixelated}.md blockquote.fancyquote{margin:25px 0 25px;text-align:left;line-height:160%}.md blockquote.fancyquote::before{content:"“";color:#DDD;font-family:Times New Roman;font-size:45px;line-height:0;margin-right:6px;vertical-align:-0.3em}.md span.fancyquote{font-size:118%;color:#777;font-style:italic}.md span.fancyquote::after{content:"”";font-style:normal;color:#DDD;font-family:Times New Roman;font-size:45px;line-height:0;margin-left:6px;vertical-align:-0.3em}.md blockquote.fancyquote .author{width:100%;margin-top:10px;display:inline-block;text-align:right}.md small{font-size:60%}.md big{font-size:150%}.md div.title,.md contents,.md .tocHeader,.md h1,.md h2,.md h3,.md h4,.md h5,.md h6,.md .shortTOC,.md .mediumTOC,.md .nonumberh1,.md .nonumberh2,.md .nonumberh3,.md .nonumberh4,.md .nonumberh5,.md .nonumberh6{font-family:Verdana,Helvetica,Arial,sans-serif;margin:13.4px 0 13.4px;padding:15px 0 3px;border-top:none;clear:both}.md .tocTop {display:none}.md h1,.md h2,.md h3,.md h4,.md h5,.md h6,.md .nonumberh1,.md .nonumberh2,.md .nonumberh3,.md .nonumberh4,.md .nonumberh5,.md .nonumberh6{page-break-after:avoid;break-after:avoid}.md svg.diagram{display:block;font-family:Menlo,Consolas,monospace;font-size:85%;text-align:center;stroke-linecap:round;stroke-width:2px;page-break-inside:avoid;stroke:#000;fill:#000}.md svg.diagram .opendot{fill:#fff}.md svg.diagram .shadeddot{fill:#CCC}.md svg.diagram .dotteddot{stroke:#000;stroke-dasharray:4;fill:none}.md svg.diagram text{stroke:none}@media print{@page{margin:1in 5mm;transform: scale(150%)}}@media print{.md .pagebreak{page-break-after:always;visibility:hidden}}.md a{font-family:Georgia,Palatino,'Times New Roman'}.md h1,.md .tocHeader,.md .nonumberh1{border-bottom:3px solid;font-size:20px;font-weight:bold;}.md h1,.md .nonumberh1{counter-reset:h2 h3 h4 h5 h6}.md h2,.md .nonumberh2{counter-reset:h3 h4 h5 h6;border-bottom:2px solid #999;color:#555;font-weight:bold;font-size:18px;}.md h3,.md h4,.md h5,.md h6,.md .nonumberh3,.md .nonumberh4,.md .nonumberh5,.md .nonumberh6{font-family:Verdana,Helvetica,Arial,sans-serif;color:#555;font-size:16px;}.md h3{counter-reset:h4 h5 h6}.md h4{counter-reset:h5 h6}.md h5{counter-reset:h6}.md div.table{margin:16px 0 16px 0}.md table{border-collapse:collapse;line-height:140%;page-break-inside:avoid}.md table.table{margin:auto}.md table.calendar{width:100%;margin:auto;font-size:11px;font-family:Verdana,Helvetica,Arial,sans-serif}.md table.calendar th{font-size:16px}.md .today{background:#ECF8FA}.md .calendar .parenthesized{color:#999;font-style:italic}.md table.table th{color:#FFF;background-color:#AAA;border:1px solid #888;padding:8px 15px 8px 15px}.md table.table td{padding:5px 15px 5px 15px;border:1px solid #888}.md table.table tr:nth-child(even){background:#EEE}.md pre.tilde{border-top: 1px solid #CCC;border-bottom: 1px solid #CCC;padding: 5px 0 5px 20px;margin:0 0 0 0;background:#FCFCFC;page-break-inside:avoid}.md a.target{width:0px;height:0px;visibility:hidden;font-size:0px;display:inline-block}.md a:link, .md a:visited{color:#38A;text-decoration:none}.md a:link:hover{text-decoration:underline}.md dt{font-weight:700}.md dl>dd{margin-top:-8px; margin-bottom:8px}.md dl>table{margin:35px 0 30px}.md code{page-break-inside:avoid;} @media print{.md .listing code{white-space:pre-wrap}}.md .endnote{font-size:13px;line-height:15px;padding-left:10px;text-indent:-10px}.md .bib{padding-left:80px;text-indent:-80px;text-align:left}.markdeepFooter{font-size:9px;text-align:right;padding-top:80px;color:#999}.md .mediumTOC{float:right;font-size:12px;line-height:15px;border-left:1px solid #CCC;padding-left:15px;margin:15px 0px 15px 25px}.md .mediumTOC .level1{font-weight:600}.md .longTOC .level1{font-weight:600;display:block;padding-top:12px;margin:0 0 -20px}.md .shortTOC{text-align:center;font-weight:bold;margin-top:15px;font-size:14px}.md .img-attrib-container .img-attrib{font-size:50%;line-height:120%;writing-mode:vertical-rl;position:absolute;bottom:0;right:0;padding:8px 4px;color:#FFF;background-color:rgba(0,0,0,.3)}.md .img-attrib-container .img-attrib a{color:#FFF;text-decoration:none}.md .admonition{position:relative;margin:1em 0;padding:.4rem 1rem;border-radius:.2rem;border-left:2.5rem solid rgba(68,138,255,.4);background-color:rgba(68,138,255,.15);}.md .admonition-title{font-weight:bold;border-bottom:solid 1px rgba(68,138,255,.4);padding-bottom:4px;margin-bottom:4px;margin-left: -1rem;padding-left:1rem;margin-right:-1rem;border-color:rgba(68,138,255,.4)}.md .admonition.tip{border-left:2.5rem solid rgba(50,255,90,.4);background-color:rgba(50,255,90,.15)}.md .admonition.tip::before{content:"\24d8";font-weight:bold;font-size:150%;position:relative;top:3px;color:rgba(26,128,46,.8);left:-2.95rem;display:block;width:0;height:0}.md .admonition.tip>.admonition-title{border-color:rgba(50,255,90,.4)}.md .admonition.warn,.md .admonition.warning{border-left:2.5rem solid rgba(255,145,0,.4);background-color:rgba(255,145,0,.15)}.md .admonition.warn::before,.md .admonition.warning::before{content:"\26A0";font-weight:bold;font-size:150%;position:relative;top:2px;color:rgba(128,73,0,.8);left:-2.95rem;display:block;width:0;height:0}.md .admonition.warn>.admonition-title,.md .admonition.warning>.admonition-title{border-color:rgba(255,145,0,.4)}.md .admonition.error{border-left: 2.5rem solid rgba(255,23,68,.4);background-color:rgba(255,23,68,.15)}.md .admonition.error>.admonition-title{border-color:rgba(255,23,68,.4)}.md .admonition.error::before{content: "\2612";font-family:"Arial";font-size:200%;position:relative;color:rgba(128,12,34,.8);top:-2px;left:-3rem;display:block;width:0;height:0}.md .admonition p:last-child{margin-bottom:0}.md li.checked,.md li.unchecked{list-style:none;overflow:visible;text-indent:-1.2em}.md li.checked:before,.md li.unchecked:before{content:"\2611";display:block;float:left;width:1em;font-size:120%}.md li.unchecked:before{content:"\2610"}</style><style>.md h1::before {
content:counter(h1) " ";
counter-increment: h1;margin-right:10px}

.md h2::before {
content:counter(h1) "."counter(h2) " ";
counter-increment: h2;margin-right:10px}

.md h3::before {
content:counter(h1) "."counter(h2) "."counter(h3) " ";
counter-increment: h3;margin-right:10px}

.md h4::before {
content:counter(h1) "."counter(h2) "."counter(h3) "."counter(h4) " ";
counter-increment: h4;margin-right:10px}

.md h5::before {
content:counter(h1) "."counter(h2) "."counter(h3) "."counter(h4) "."counter(h5) " ";
counter-increment: h5;margin-right:10px}

.md h6::before {
content:counter(h1) "."counter(h2) "."counter(h3) "."counter(h4) "."counter(h5) "."counter(h6) " ";
counter-increment: h6;margin-right:10px}

</style><style>.hljs{display:block;overflow-x:auto;padding:0.5em;background:#fff;color:#000;-webkit-text-size-adjust:none}.hljs-comment{color:#006a00}.hljs-keyword{color:#02E}.hljs-literal,.nginx .hljs-title{color:#aa0d91}.method,.hljs-list .hljs-title,.hljs-tag .hljs-title,.setting .hljs-value,.hljs-winutils,.tex .hljs-command,.http .hljs-title,.hljs-request,.hljs-status,.hljs-name{color:#008}.hljs-envvar,.tex .hljs-special{color:#660}.hljs-string{color:#c41a16}.hljs-tag .hljs-value,.hljs-cdata,.hljs-filter .hljs-argument,.hljs-attr_selector,.apache .hljs-cbracket,.hljs-date,.hljs-regexp{color:#080}.hljs-sub .hljs-identifier,.hljs-pi,.hljs-tag,.hljs-tag .hljs-keyword,.hljs-decorator,.ini .hljs-title,.hljs-shebang,.hljs-prompt,.hljs-hexcolor,.hljs-rule .hljs-value,.hljs-symbol,.hljs-symbol .hljs-string,.hljs-number,.css .hljs-function,.hljs-function .hljs-title,.coffeescript .hljs-attribute{color:#A0C}.hljs-function .hljs-title{font-weight:bold;color:#000}.hljs-class .hljs-title,.smalltalk .hljs-class,.hljs-type,.hljs-typename,.hljs-tag .hljs-attribute,.hljs-doctype,.hljs-class .hljs-id,.hljs-built_in,.setting,.hljs-params,.clojure .hljs-attribute{color:#5c2699}.hljs-variable{color:#3f6e74}.css .hljs-tag,.hljs-rule .hljs-property,.hljs-pseudo,.hljs-subst{color:#000}.css .hljs-class,.css .hljs-id{color:#9b703f}.hljs-value .hljs-important{color:#ff7700;font-weight:bold}.hljs-rule .hljs-keyword{color:#c5af75}.hljs-annotation,.apache .hljs-sqbracket,.nginx .hljs-built_in{color:#9b859d}.hljs-preprocessor,.hljs-preprocessor *,.hljs-pragma{color:#643820}.tex .hljs-formula{background-color:#eee;font-style:italic}.diff .hljs-header,.hljs-chunk{color:#808080;font-weight:bold}.diff .hljs-change{background-color:#bccff9}.hljs-addition{background-color:#baeeba}.hljs-deletion{background-color:#ffc8bd}.hljs-comment .hljs-doctag{font-weight:bold}.method .hljs-id{color:#000}</style><style>div.title { padding-top: 40px; } div.afterTitles { height: 15px; }</style> 
<meta name="format-detection" content="telephone=no">

<script src="chrome-extension://nngceckbapebfimnlniiiahkandclblb/content/fido2/page-script.js" id="bw-fido2-page-script"></script><script type="text/javascript" src="./index.md_files/MathJax.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover, .MJXp-munder {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > *, .MJXp-munder > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none; box-sizing: content-box}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_test {font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow: hidden; height: 1px}
.MathJax_test.mjx-test-display {display: table!important}
.MathJax_test.mjx-test-inline {display: inline!important; margin-right: -1px}
.MathJax_test.mjx-test-default {display: block!important; clear: both}
.MathJax_ex_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60ex}
.MathJax_em_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60em}
.mjx-test-inline .MathJax_left_box {display: inline-block; width: 0; float: left}
.mjx-test-inline .MathJax_right_box {display: inline-block; width: 0; float: right}
.mjx-test-display .MathJax_right_box {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.6') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.6') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.6') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.6') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.6') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.6') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.6') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.6') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.6') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.6') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.6') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.6') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.6') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.6') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.6') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.6') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.6') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.6') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head><body id="md" class="" style="visibility: visible;"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"><br></div></div><div id="MathJax_Message" style="display: none;"></div><script type="text/x-mathjax-config;executed=true">MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "AMS"} } });</script><span style="display:none"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot; /&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 0em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(3.849em, 1000em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mrow" id="MathJax-Span-2"></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.128em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-1">\newcommand{\n}{\hat{n}}\newcommand{\thetai}{\theta_\mathrm{i}}\newcommand{\thetao}{\theta_\mathrm{o}}\newcommand{\d}[1]{\mathrm{d}#1}\newcommand{\w}{\hat{\omega}}\newcommand{\wi}{\w_\mathrm{i}}\newcommand{\wo}{\w_\mathrm{o}}\newcommand{\wh}{\w_\mathrm{h}}\newcommand{\Li}{L_\mathrm{i}}\newcommand{\Lo}{L_\mathrm{o}}\newcommand{\Le}{L_\mathrm{e}}\newcommand{\Lr}{L_\mathrm{r}}\newcommand{\Lt}{L_\mathrm{t}}\newcommand{\O}{\mathrm{O}}\newcommand{\degrees}{{^{\large\circ}}}\newcommand{\T}{\mathsf{T}}\newcommand{\mathset}[1]{\mathbb{#1}}\newcommand{\Real}{\mathset{R}}\newcommand{\Integer}{\mathset{Z}}\newcommand{\Boolean}{\mathset{B}}\newcommand{\Complex}{\mathset{C}}\newcommand{\un}[1]{\,\mathrm{#1}}</script>
</span>
<span class="md"><p>
<a class="target" name="hashlife">&nbsp;</a><a class="target" name="hashlife">&nbsp;</a><a class="target" name="toc1">&nbsp;</a></p><h1>Hashlife</h1>
<p>

</p><center><div class="image" style=""><a href="./index.md_files/header.png" target="_blank"><img class="markdeep" src="./index.md_files/header.png"></a><center><span class="imagecaption"> </span></center></div></center>

<p></p><p>

The <a href="https://en.wikipedia.org/wiki/Hashlife">Hashlife algorithm</a> was invented by Bill Gosper in [<a href="https://johnhw.github.io/hashlife/index.md.html#citation-gosper1984">Gosper1984</a>] to speed up evaluation of the Game of Life for huge or very long running patterns using a memoized quadtree. It is a very ingenious algorithm and one that has some subtlety in implementation. There are several good explanations on the web, including <a href="https://www.drdobbs.com/jvm/an-algorithm-for-compressing-space-and-t/184406478">Tomas Rokicki's Dr. Dobbs article</a> and <a href="https://jennyhasahat.github.io/hashlife.html">Jenny Owen's explanation</a>. This post explains a simple Python implementation. 

</p>
<a class="target" name="download">&nbsp;</a><a class="target" name="hashlife/download">&nbsp;</a><a class="target" name="toc1.1">&nbsp;</a><h2>Download</h2>
<p>


<a href="https://github.com/johnhw/hashlife">You can download the source for the implementation</a>.

</p>
<a class="target" name="gameoflifealgorithms">&nbsp;</a><a class="target" name="hashlife/gameoflifealgorithms">&nbsp;</a><a class="target" name="toc1.2">&nbsp;</a><h2>Game of Life algorithms</h2>
<p>

I'll assume you are familiar with the <a href="https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life">Game of Life</a>.

</p><p>

There are a huge number of clever ways to implement Conway's Game of Life, including:

</p><p>

</p><ul>
<li class="asterisk">the naive grid counting implementation with 2D arrays, 
</li>
<li class="asterisk">super fast bit-fiddling like <a href="http://dotat.at/prog/life/life.html">Tony Finch's version</a> or <a href="https://github.com/rokicki/lifealg">Tomas Rokicki's various versions</a>
</li>
<li class="asterisk"><a href="http://www.marekfiser.com/Projects/Conways-Game-of-Life-on-GPU-using-CUDA">Accelerated GPU-based algorithms</a>
</li>
<li class="asterisk">algorithms that rewrite GoL as a different 2×2 16-state automata and simulate that instead <a href="https://github.com/johnhw/glgol">like Callahan's algorithm</a>. 
</li>
<li class="asterisk"><a href="https://www.researchgate.net/publication/222758581_Asynchronous_game_of_life">asynchronous update algorithms</a> 
</li>
<li class="asterisk">and, of course, <a href="https://www.conwaylife.com/wiki/Unit_cell">implementations in the Game of Life itself</a>.</li></ul>

<p></p>
<a class="target" name="simpleimplementations">&nbsp;</a><a class="target" name="hashlife/gameoflifealgorithms/simpleimplementations">&nbsp;</a><a class="target" name="toc1.2.1">&nbsp;</a><h3>Simple implementations</h3>
<p>

Ignoring the complexities of loading patterns and display output, the basic algorithm for the GoL can be very simple indeed. If we have a collection of “on” cells stored as <code>(x,y)</code> pairs, a tiny Python program to compute the next generation is:

</p><pre class="listing backtick"><code><span class="line"></span><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> Counter
<span class="line"></span><span class="hljs-keyword">def</span> <span class="hljs-title function_">life</span>(<span class="hljs-params">pts</span>):    
<span class="line"></span>    ns = Counter([(x+a, y+b) <span class="hljs-keyword">for</span> x,y <span class="hljs-keyword">in</span> pts <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> [-<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> [-<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>]])
<span class="line"></span>    <span class="hljs-keyword">return</span> Counter([p <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> ns <span class="hljs-keyword">if</span> ns[p]==<span class="hljs-number">3</span> <span class="hljs-keyword">or</span> (ns[p]==<span class="hljs-number">4</span> <span class="hljs-keyword">and</span> p <span class="hljs-keyword">in</span> pts)])</code></pre><p>

This implementation has no limits on universe size, other than memory limitations and only computes updates near live cells. It's not very fast, though!

</p><p>

The Game of Life is also easy to write as a convolution of a binary matrix, for example with SciPy:

</p><pre class="listing backtick"><code><span class="line"></span><span class="hljs-keyword">from</span> scipy.ndimage <span class="hljs-keyword">import</span> convolve
<span class="line"></span>k = np.array([<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>]).reshape(<span class="hljs-number">3</span>,<span class="hljs-number">3</span>)
<span class="line"></span>
<span class="line"></span><span class="hljs-keyword">def</span> <span class="hljs-title function_">life</span>(<span class="hljs-params">cells</span>):
<span class="line"></span>    result = convolve(cells, k, mode=<span class="hljs-string">"wrap"</span>)
<span class="line"></span>    <span class="hljs-keyword">return</span> (result&gt;<span class="hljs-number">4</span>) &amp; (result&lt;<span class="hljs-number">8</span>)</code></pre><p>
This is a very simple form to parallelise, e.g. on the GPU, but requires storing a dense matrix and computing an update for every allocated cell (no skipping blank space).

</p>
<a class="target" name="hashlife">&nbsp;</a><a class="target" name="hashlife/gameoflifealgorithms/hashlife">&nbsp;</a><a class="target" name="toc1.2.2">&nbsp;</a><h3>Hashlife</h3>
<p>

Hashlife is designed to be able to run a cellular automaton quickly, by pre-caching successors to states have seen before. To make this efficient, we cache things in a quadtree using a hierarchy over both space and time. This allows Hashlife to, for example, compute the state of repetitive patterns <strong class="asterisk">trillions</strong> of generations in the future and easily store the result.

</p><p>

Hashlife is very fast for periodic patterns run for long stretches. It is not efficient for chaotic patterns (it will rapidly run out of memory and grind to a halt) and it is not very useful for interactive display, as displaying each generation is a huge overhead.

</p>
<a class="target" name="hashlifealgorithm">&nbsp;</a><a class="target" name="hashlife/hashlifealgorithm">&nbsp;</a><a class="target" name="toc1.3">&nbsp;</a><h2>Hashlife algorithm</h2>
<p>

We operate on a quadtree, where each node has four children, each of which has four children, etc, until we reach leaf nodes:

</p><p>

<svg class="diagram" xmlns="http://www.w3.org/2000/svg" version="1.1" height="320" width="240" style="margin:0 auto 0 auto;"><g transform="translate(8,16 )">
<path d="M 8,16 L 8,288 " style="fill:none;"></path>
<path d="M 40,48 L 40,240 " style="fill:none;"></path>
<path d="M 56,80 L 56,128 " style="fill:none;"></path>
<path d="M 56,176 L 56,224 " style="fill:none;"></path>
<path d="M 80,80 L 80,128 " style="fill:none;"></path>
<path d="M 80,176 L 80,224 " style="fill:none;"></path>
<path d="M 96,80 L 96,128 " style="fill:none;"></path>
<path d="M 96,176 L 96,224 " style="fill:none;"></path>
<path d="M 120,80 L 120,128 " style="fill:none;"></path>
<path d="M 120,176 L 120,224 " style="fill:none;"></path>
<path d="M 136,48 L 136,240 " style="fill:none;"></path>
<path d="M 160,16 L 160,288 " style="fill:none;"></path>
<path d="M 8,16 L 216,16 " style="fill:none;"></path>
<path d="M 40,48 L 136,48 " style="fill:none;"></path>
<path d="M 56,80 L 80,80 " style="fill:none;"></path>
<path d="M 96,80 L 120,80 " style="fill:none;"></path>
<path d="M 56,128 L 80,128 " style="fill:none;"></path>
<path d="M 96,128 L 120,128 " style="fill:none;"></path>
<path d="M 56,176 L 80,176 " style="fill:none;"></path>
<path d="M 96,176 L 120,176 " style="fill:none;"></path>
<path d="M 56,224 L 80,224 " style="fill:none;"></path>
<path d="M 96,224 L 120,224 " style="fill:none;"></path>
<path d="M 40,240 L 136,240 " style="fill:none;"></path>
<path d="M 8,272 L 224,272 " style="fill:none;"></path>
<g transform="translate(0,0)"><text text-anchor="middle" x="24" y="36">A</text><text text-anchor="middle" x="184" y="36">B</text><text text-anchor="middle" x="200" y="36">.</text><text text-anchor="middle" x="208" y="36">.</text><text text-anchor="middle" x="216" y="36">.</text><text text-anchor="middle" x="64" y="68">A</text><text text-anchor="middle" x="104" y="68">B</text><text text-anchor="middle" x="64" y="100">A</text><text text-anchor="middle" x="72" y="100">B</text><text text-anchor="middle" x="104" y="100">A</text><text text-anchor="middle" x="112" y="100">B</text><text text-anchor="middle" x="64" y="116">C</text><text text-anchor="middle" x="72" y="116">D</text><text text-anchor="middle" x="104" y="116">C</text><text text-anchor="middle" x="112" y="116">D</text><text text-anchor="middle" x="64" y="164">C</text><text text-anchor="middle" x="104" y="164">D</text><text text-anchor="middle" x="64" y="196">A</text><text text-anchor="middle" x="72" y="196">B</text><text text-anchor="middle" x="104" y="196">A</text><text text-anchor="middle" x="112" y="196">B</text><text text-anchor="middle" x="64" y="212">C</text><text text-anchor="middle" x="72" y="212">D</text><text text-anchor="middle" x="104" y="212">C</text><text text-anchor="middle" x="112" y="212">D</text><text text-anchor="middle" x="24" y="292">C</text><text text-anchor="middle" x="48" y="292">.</text><text text-anchor="middle" x="56" y="292">.</text><text text-anchor="middle" x="64" y="292">.</text><text text-anchor="middle" x="176" y="292">D</text><text text-anchor="middle" x="192" y="292">.</text><text text-anchor="middle" x="200" y="292">.</text><text text-anchor="middle" x="208" y="292">.</text></g></g></svg>

</p><p>

Leaf nodes are individual cells, either <code>on</code> or <code>off</code>. 

</p>
<a class="target" name="levels">&nbsp;</a><a class="target" name="hashlife/levels">&nbsp;</a><a class="target" name="toc1.4">&nbsp;</a><h2>Levels</h2>
<p>


Each node has a <strong class="asterisk">level</strong> <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3" style="width: 0.644em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.537em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.124em, 1000.54em, 2.139em, -999.997em); top: -1.974em; left: 0em;"><span class="mrow" id="MathJax-Span-4"><span class="mi" id="MathJax-Span-5" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 1.979em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">k</script>, where the size of the node is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6" style="width: 3.689em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.154em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.231em, 1003.15em, 2.46em, -999.997em); top: -2.294em; left: 0em;"><span class="mrow" id="MathJax-Span-7"><span class="msubsup" id="MathJax-Span-8"><span style="display: inline-block; position: relative; width: 0.964em; height: 0px;"><span style="position: absolute; clip: rect(3.208em, 1000.43em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mn" id="MathJax-Span-9" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.378em; left: 0.483em;"><span class="mi" id="MathJax-Span-10" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span><span class="mo" id="MathJax-Span-11" style="font-family: MathJax_Main; padding-left: 0.216em;">×</span><span class="msubsup" id="MathJax-Span-12" style="padding-left: 0.216em;"><span style="display: inline-block; position: relative; width: 0.964em; height: 0px;"><span style="position: absolute; clip: rect(3.208em, 1000.43em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mn" id="MathJax-Span-13" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.378em; left: 0.483em;"><span class="mi" id="MathJax-Span-14" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.3em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mi>k</mi></msup><mo>×</mo><msup><mn>2</mn><mi>k</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-3">2^k \times 2^k</script> cells.

</p><p>

</p><ul>
<li class="asterisk">level 0 is a 1×1 block (leaf node) which are just binary values, on or off.
</li>
<li class="asterisk">level 1 is a 2×2 block whose children are level 0 blocks
</li>
<li class="asterisk">level 2 is 4×4 block whose children are level 1 blocks
</li>
<li class="asterisk">level 3 is an 8×8 block whose children are level 2 blocks
</li>
<li class="asterisk">etc.</li></ul>

<p></p><p>

The Hashlife algorithm defines an recursive process that:

</p><p>

</p><ul>
<li class="asterisk">takes a level <code>k</code> node, size <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-15" style="width: 3.689em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.154em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.231em, 1003.15em, 2.46em, -999.997em); top: -2.294em; left: 0em;"><span class="mrow" id="MathJax-Span-16"><span class="msubsup" id="MathJax-Span-17"><span style="display: inline-block; position: relative; width: 0.964em; height: 0px;"><span style="position: absolute; clip: rect(3.208em, 1000.43em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mn" id="MathJax-Span-18" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.378em; left: 0.483em;"><span class="mi" id="MathJax-Span-19" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span><span class="mo" id="MathJax-Span-20" style="font-family: MathJax_Main; padding-left: 0.216em;">×</span><span class="msubsup" id="MathJax-Span-21" style="padding-left: 0.216em;"><span style="display: inline-block; position: relative; width: 0.964em; height: 0px;"><span style="position: absolute; clip: rect(3.208em, 1000.43em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mn" id="MathJax-Span-22" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.378em; left: 0.483em;"><span class="mi" id="MathJax-Span-23" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.3em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mi>k</mi></msup><mo>×</mo><msup><mn>2</mn><mi>k</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-4">2^k \times 2^k</script> 
</li>
<li class="asterisk">returns a level <code>k-1</code> node, size <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-24" style="width: 5.825em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.971em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.231em, 1004.97em, 2.46em, -999.997em); top: -2.294em; left: 0em;"><span class="mrow" id="MathJax-Span-25"><span class="msubsup" id="MathJax-Span-26"><span style="display: inline-block; position: relative; width: 1.872em; height: 0px;"><span style="position: absolute; clip: rect(3.208em, 1000.43em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mn" id="MathJax-Span-27" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.378em; left: 0.483em;"><span class="texatom" id="MathJax-Span-28"><span class="mrow" id="MathJax-Span-29"><span class="mi" id="MathJax-Span-30" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-31" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-32" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span><span class="mo" id="MathJax-Span-33" style="font-family: MathJax_Main; padding-left: 0.216em;">×</span><span class="msubsup" id="MathJax-Span-34" style="padding-left: 0.216em;"><span style="display: inline-block; position: relative; width: 1.872em; height: 0px;"><span style="position: absolute; clip: rect(3.208em, 1000.43em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mn" id="MathJax-Span-35" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.378em; left: 0.483em;"><span class="texatom" id="MathJax-Span-36"><span class="mrow" id="MathJax-Span-37"><span class="mi" id="MathJax-Span-38" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-39" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-40" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.3em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>×</mo><msup><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-5">2^{k-1} \times 2^{k-1}</script>
</li>
<li class="asterisk">advanced <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-41" style="width: 2.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.872em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(-0.051em, 1001.87em, 1.178em, -999.997em); top: -1.012em; left: 0em;"><span class="mrow" id="MathJax-Span-42"><span class="msubsup" id="MathJax-Span-43"><span style="display: inline-block; position: relative; width: 1.872em; height: 0px;"><span style="position: absolute; clip: rect(3.208em, 1000.43em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mn" id="MathJax-Span-44" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.378em; left: 0.483em;"><span class="texatom" id="MathJax-Span-45"><span class="mrow" id="MathJax-Span-46"><span class="mi" id="MathJax-Span-47" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-48" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-49" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.018em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>2</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-6">2^{k-2}</script> generations in time.</li></ul>

<p></p><p>

Eventually, we end up processing blocks of size 4×4 (<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-50" style="width: 2.78em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.353em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.338em, 1002.3em, 2.353em, -999.997em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-51"><span class="mi" id="MathJax-Span-52" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-53" style="font-family: MathJax_Main; padding-left: 0.27em;">=</span><span class="mn" id="MathJax-Span-54" style="font-family: MathJax_Main; padding-left: 0.27em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.193em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>=</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-7">k=2</script>), where we can use basic brute-force, computing the 2×2 successor of a 4×4 cell by straightforward computation. 
The clever part is that by memoizing the recursion to cache the intermediate products, we can <em class="asterisk">dramatically</em> reduce computation requirements, as most CA patterns are very repetitive in space and in time.

</p>
<a class="target" name="inpython">&nbsp;</a><a class="target" name="inpython">&nbsp;</a><a class="target" name="toc2">&nbsp;</a><h1>In Python</h1>

<a class="target" name="datastructures">&nbsp;</a><a class="target" name="inpython/datastructures">&nbsp;</a><a class="target" name="toc2.1">&nbsp;</a><h2>Datastructures</h2>
<p>


Patterns are stored as a <strong class="asterisk">quadtree</strong> representing the state of the world at step <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-55" style="width: 0.43em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.377em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.178em, 1000.32em, 2.139em, -999.997em); top: -1.974em; left: 0em;"><span class="mrow" id="MathJax-Span-56"><span class="mi" id="MathJax-Span-57" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 1.979em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">t</script>. A quadtree node is a tuple <code>node(k, a, b, c, d, n, hash)</code>, where 

</p><p>

</p><ul>
<li class="asterisk"><code>k</code> is the level of the node
</li>
<li class="asterisk"><code>a, b, c, d</code> are the children of this node (or None, if <code>k=0</code>).
</li>
<li class="asterisk"><code>n</code> is the number of on cells in this node (useful for bookkeeping and display) 
</li>
<li class="asterisk"><code>hash</code> is a precomputed hash of this node (if we don't do this, Python will recursively compute the hash every time it is needed!)</li></ul>

<p></p><pre class="listing backtick"><code><span class="line"></span><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> namedtuple
<span class="line"></span>_Node = namedtuple(<span class="hljs-string">"Node"</span>, [<span class="hljs-string">"k"</span>, <span class="hljs-string">"a"</span>, <span class="hljs-string">"b"</span>, <span class="hljs-string">"c"</span>, <span class="hljs-string">"d"</span>, <span class="hljs-string">"n"</span>, <span class="hljs-string">"hash"</span>])
<span class="line"></span>
<span class="line"></span><span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span>(<span class="hljs-title class_ inherited__">_Node</span>):    
<span class="line"></span>     <span class="hljs-keyword">def</span> <span class="hljs-title function_">__hash__</span>(<span class="hljs-params">self</span>):
<span class="line"></span>        <span class="hljs-keyword">return</span> self.<span class="hljs-built_in">hash</span>
<span class="line"></span>    
<span class="line"></span>     <span class="hljs-keyword">def</span> <span class="hljs-title function_">__repr__</span>(<span class="hljs-params">self</span>):        
<span class="line"></span>        <span class="hljs-keyword">return</span> <span class="hljs-string">f"Node k=<span class="hljs-subst">{self.k}</span>, <span class="hljs-subst">{<span class="hljs-number">1</span>&lt;&lt;self.k}</span> x <span class="hljs-subst">{<span class="hljs-number">1</span>&lt;&lt;self.k}</span>, pop <span class="hljs-subst">{self.n}</span>"</span>        
<span class="line"></span></code></pre><p>

We have two base level nodes, <code>on</code> and <code>off</code>

</p><pre class="listing backtick"><code><span class="line"></span>on = Node(<span class="hljs-number">0</span>, <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)
<span class="line"></span>off = Node(<span class="hljs-number">0</span>, <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)</code></pre><p>

Everything else in terms of memoization handled using <code>lru_cache</code> from <code>functools</code> which gives us an automatically garbage-collected and size-limited cache.

</p>
<a class="target" name="functions">&nbsp;</a><a class="target" name="inpython/functions">&nbsp;</a><a class="target" name="toc2.2">&nbsp;</a><h2>Functions</h2>
<p>



</p><ul>
<li class="asterisk"><strong class="asterisk">join(a,b,c,d)</strong> combine four children at level <code>k-1</code> to a new node at level <code>k</code>. If this is cached, return the cached node. Otherwise, create a new node, and add it to the cache.</li></ul>

<p></p><p>

<svg class="diagram" xmlns="http://www.w3.org/2000/svg" version="1.1" height="96" width="256" style="margin:0 auto 0 auto;"><g transform="translate(8,16 )">
<path d="M 104,0 L 104,64 " style="fill:none;"></path>
<path d="M 168,0 L 168,64 " style="fill:none;"></path>
<path d="M 224,16 L 224,48 " style="fill:none;"></path>
<path d="M 240,16 L 240,48 " style="fill:none;"></path>
<path d="M 104,0 L 168,0 " style="fill:none;"></path>
<path d="M 224,16 L 240,16 " style="fill:none;"></path>
<path d="M 192,32 L 208,32 " style="fill:none;"></path>
<path d="M 224,48 L 240,48 " style="fill:none;"></path>
<path d="M 104,64 L 168,64 " style="fill:none;"></path>
<polygon points="216,32 204,26.4 204,37.6 " style="stroke:none" transform="rotate(0,208,32 )"></polygon>
<g transform="translate(0,0)"><text text-anchor="middle" x="120" y="20">A</text><text text-anchor="middle" x="152" y="20">B</text><text text-anchor="middle" x="232" y="36">N</text><text text-anchor="middle" x="120" y="52">C</text><text text-anchor="middle" x="152" y="52">D</text></g></g></svg>

</p><p>

We can use the <a href="https://docs.python.org/3/library/functools.html">least recently used cache</a> to automatically cache results, so we eliminate repeated nodes:

</p><pre class="listing backtick"><code><span class="line"></span><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> lru_cache
<span class="line"></span>
<span class="line"></span><span class="hljs-meta">@lru_cache(<span class="hljs-params">maxsize=<span class="hljs-number">2</span>**<span class="hljs-number">24</span></span>)</span>
<span class="line"></span><span class="hljs-keyword">def</span> <span class="hljs-title function_">join</span>(<span class="hljs-params">a, b, c, d</span>):        
<span class="line"></span>    n = a.n + b.n + c.n + d.n
<span class="line"></span>    nhash = (
<span class="line"></span>            a.k + <span class="hljs-number">2</span> +
<span class="line"></span>            + <span class="hljs-number">5131830419411</span> * a.<span class="hljs-built_in">hash</span> + <span class="hljs-number">3758991985019</span> * b.<span class="hljs-built_in">hash</span>
<span class="line"></span>            + <span class="hljs-number">8973110871315</span> * c.<span class="hljs-built_in">hash</span> + <span class="hljs-number">4318490180473</span> * d.<span class="hljs-built_in">hash</span>
<span class="line"></span>        ) &amp; ((<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">63</span>) - <span class="hljs-number">1</span>)    
<span class="line"></span>    <span class="hljs-keyword">return</span> Node(a.k + <span class="hljs-number">1</span>, a, b, c, d, n, nhash) </code></pre><p>

The hashing constants are arbitrary. A custom hash is needed to make sure the hash is computed only once.

</p><p>

</p><ul>
<li class="asterisk"><strong class="asterisk">get_zero(k)</strong> return an empty node at level <code>k</code>:</li></ul>

<p></p><pre class="listing backtick"><code><span class="line"></span><span class="hljs-meta">@lru_cache(<span class="hljs-params">maxsize=<span class="hljs-number">1024</span></span>)</span>
<span class="line"></span><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_zero</span>(<span class="hljs-params">k</span>):
<span class="line"></span>    <span class="hljs-keyword">return</span> off <span class="hljs-keyword">if</span> k==<span class="hljs-number">0</span> <span class="hljs-keyword">else</span> join(get_zero(k - <span class="hljs-number">1</span>), get_zero(k - <span class="hljs-number">1</span>), 
<span class="line"></span>                                 get_zero(k - <span class="hljs-number">1</span>), get_zero(k - <span class="hljs-number">1</span>))    </code></pre><p>


</p><ul>
<li class="asterisk"><strong class="asterisk">centre(node)</strong>  return a node at level <code>k+1</code>, which is centered on the given quadtree node:</li></ul>

<p></p><p>

<svg class="diagram" xmlns="http://www.w3.org/2000/svg" version="1.1" height="160" width="368" style="margin:0 auto 0 auto;"><g transform="translate(8,16 )">
<path d="M 16,48 L 16,112 " style="fill:none;"></path>
<path d="M 96,48 L 96,112 " style="fill:none;"></path>
<path d="M 216,0 L 216,128 " style="fill:none;"></path>
<path d="M 352,0 L 352,128 " style="fill:none;"></path>
<path d="M 216,0 L 352,0 " style="fill:none;"></path>
<path d="M 16,48 L 96,48 " style="fill:none;"></path>
<path d="M 136,80 L 152,80 " style="fill:none;"></path>
<path d="M 16,112 L 96,112 " style="fill:none;"></path>
<path d="M 216,128 L 352,128 " style="fill:none;"></path>
<polygon points="160,80 148,74.4 148,85.6 " style="stroke:none" transform="rotate(0,152,80 )"></polygon>
<g transform="translate(0,0)"><text text-anchor="middle" x="232" y="20">0</text><text text-anchor="middle" x="264" y="20">0</text><text text-anchor="middle" x="304" y="20">0</text><text text-anchor="middle" x="336" y="20">0</text><text text-anchor="middle" x="232" y="52">0</text><text text-anchor="middle" x="264" y="52">A</text><text text-anchor="middle" x="304" y="52">B</text><text text-anchor="middle" x="336" y="52">0</text><text text-anchor="middle" x="32" y="68">A</text><text text-anchor="middle" x="72" y="68">B</text><text text-anchor="middle" x="232" y="84">0</text><text text-anchor="middle" x="264" y="84">C</text><text text-anchor="middle" x="304" y="84">D</text><text text-anchor="middle" x="336" y="84">0</text><text text-anchor="middle" x="32" y="100">C</text><text text-anchor="middle" x="72" y="100">D</text><text text-anchor="middle" x="232" y="116">0</text><text text-anchor="middle" x="264" y="116">0</text><text text-anchor="middle" x="304" y="116">0</text><text text-anchor="middle" x="336" y="116">0</text></g></g></svg>

</p><p>

**

</p><pre class="listing backtick"><code><span class="line"></span><span class="hljs-keyword">def</span> <span class="hljs-title function_">centre</span>(<span class="hljs-params">m</span>):
<span class="line"></span>    z = get_zero(m.k - <span class="hljs-number">1</span>)  
<span class="line"></span>    <span class="hljs-keyword">return</span> join(
<span class="line"></span>        join(z, z, z, m.a), join(z, z, m.b, z),
<span class="line"></span>        join(z, m.c, z, z), join(m.d, z, z, z)
<span class="line"></span>    )</code></pre><p>


</p><ul>
<li class="asterisk"><strong class="asterisk">life_4×4(node)</strong> return the next generation of a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-58" style="width: 2.78em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.353em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.338em, 1002.3em, 2.353em, -999.997em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-59"><span class="mi" id="MathJax-Span-60" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-61" style="font-family: MathJax_Main; padding-left: 0.27em;">=</span><span class="mn" id="MathJax-Span-62" style="font-family: MathJax_Main; padding-left: 0.27em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.193em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>=</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-9">k=2</script> (i.e. 4×4) cell. To terminate the recursion, at the base level, if we have a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-63" style="width: 2.78em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.353em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.338em, 1002.3em, 2.353em, -999.997em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-64"><span class="mi" id="MathJax-Span-65" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-66" style="font-family: MathJax_Main; padding-left: 0.27em;">=</span><span class="mn" id="MathJax-Span-67" style="font-family: MathJax_Main; padding-left: 0.27em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.193em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>=</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-10">k=2</script> 4×4 block, we can compute the 2×2 central successor by iterating over all the 3×3 sub-neighbourhoods of 1×1 cells using the standard Life rule (or any other Moore-neighbourhood binary cellular automaton rule we choose):</li></ul>

<p></p><p>

<svg class="diagram" xmlns="http://www.w3.org/2000/svg" version="1.1" height="224" width="448" style="margin:0 auto 0 auto;"><g transform="translate(8,16 )">
<path d="M 8,0 L 8,64 " style="fill:none;"></path>
<path d="M 8,128 L 8,192 " style="fill:none;"></path>
<path d="M 112,0 L 112,64 " style="fill:none;"></path>
<path d="M 112,128 L 112,192 " style="fill:none;"></path>
<path d="M 224,0 L 224,192 " style="fill:none;"></path>
<path d="M 272,0 L 272,64 " style="fill:none;"></path>
<path d="M 272,128 L 272,192 " style="fill:none;"></path>
<path d="M 376,0 L 376,64 " style="fill:none;"></path>
<path d="M 376,128 L 376,192 " style="fill:none;"></path>
<path d="M 8,0 L 112,0 " style="fill:none;"></path>
<path d="M 272,0 L 376,0 " style="fill:none;"></path>
<path d="M 160,32 L 176,32 " style="fill:none;"></path>
<path d="M 392,32 L 408,32 " style="fill:none;"></path>
<path d="M 8,64 L 112,64 " style="fill:none;"></path>
<path d="M 272,64 L 376,64 " style="fill:none;"></path>
<path d="M 0,96 L 432,96 " style="fill:none;"></path>
<path d="M 8,128 L 112,128 " style="fill:none;"></path>
<path d="M 272,128 L 376,128 " style="fill:none;"></path>
<path d="M 160,160 L 176,160 " style="fill:none;"></path>
<path d="M 392,160 L 408,160 " style="fill:none;"></path>
<path d="M 8,192 L 112,192 " style="fill:none;"></path>
<path d="M 272,192 L 376,192 " style="fill:none;"></path>
<polygon points="416,160 404,154.4 404,165.6 " style="stroke:none" transform="rotate(0,408,160 )"></polygon>
<polygon points="416,32 404,26.4 404,37.6 " style="stroke:none" transform="rotate(0,408,32 )"></polygon>
<polygon points="184,160 172,154.4 172,165.6 " style="stroke:none" transform="rotate(0,176,160 )"></polygon>
<polygon points="184,32 172,26.4 172,37.6 " style="stroke:none" transform="rotate(0,176,32 )"></polygon>
<g transform="translate(0,0)"><text text-anchor="middle" x="24" y="20">A</text><text text-anchor="middle" x="32" y="20">A</text><text text-anchor="middle" x="56" y="20">A</text><text text-anchor="middle" x="64" y="20">B</text><text text-anchor="middle" x="88" y="20">B</text><text text-anchor="middle" x="96" y="20">A</text><text text-anchor="middle" x="128" y="20">B</text><text text-anchor="middle" x="136" y="20">B</text><text text-anchor="middle" x="248" y="20">A</text><text text-anchor="middle" x="256" y="20">A</text><text text-anchor="middle" x="288" y="20">A</text><text text-anchor="middle" x="296" y="20">B</text><text text-anchor="middle" x="320" y="20">B</text><text text-anchor="middle" x="328" y="20">A</text><text text-anchor="middle" x="352" y="20">B</text><text text-anchor="middle" x="360" y="20">B</text><text text-anchor="middle" x="24" y="36">A</text><text text-anchor="middle" x="32" y="36">C</text><text text-anchor="middle" x="56" y="36">A</text><text text-anchor="middle" x="64" y="36">D</text><text text-anchor="middle" x="88" y="36">B</text><text text-anchor="middle" x="96" y="36">C</text><text text-anchor="middle" x="128" y="36">B</text><text text-anchor="middle" x="136" y="36">D</text><text text-anchor="middle" x="192" y="36">a</text><text text-anchor="middle" x="200" y="36">d</text><text text-anchor="middle" x="248" y="36">A</text><text text-anchor="middle" x="256" y="36">C</text><text text-anchor="middle" x="288" y="36">A</text><text text-anchor="middle" x="296" y="36">D</text><text text-anchor="middle" x="320" y="36">B</text><text text-anchor="middle" x="328" y="36">C</text><text text-anchor="middle" x="352" y="36">B</text><text text-anchor="middle" x="360" y="36">D</text><text text-anchor="middle" x="424" y="36">b</text><text text-anchor="middle" x="432" y="36">c</text><text text-anchor="middle" x="24" y="52">C</text><text text-anchor="middle" x="32" y="52">A</text><text text-anchor="middle" x="56" y="52">C</text><text text-anchor="middle" x="64" y="52">B</text><text text-anchor="middle" x="88" y="52">D</text><text text-anchor="middle" x="96" y="52">A</text><text text-anchor="middle" x="128" y="52">D</text><text text-anchor="middle" x="136" y="52">B</text><text text-anchor="middle" x="248" y="52">C</text><text text-anchor="middle" x="256" y="52">A</text><text text-anchor="middle" x="288" y="52">C</text><text text-anchor="middle" x="296" y="52">B</text><text text-anchor="middle" x="320" y="52">D</text><text text-anchor="middle" x="328" y="52">A</text><text text-anchor="middle" x="352" y="52">D</text><text text-anchor="middle" x="360" y="52">B</text><text text-anchor="middle" x="8" y="84">C</text><text text-anchor="middle" x="16" y="84">C</text><text text-anchor="middle" x="48" y="84">C</text><text text-anchor="middle" x="56" y="84">D</text><text text-anchor="middle" x="88" y="84">D</text><text text-anchor="middle" x="96" y="84">C</text><text text-anchor="middle" x="120" y="84">D</text><text text-anchor="middle" x="128" y="84">D</text><text text-anchor="middle" x="248" y="84">C</text><text text-anchor="middle" x="256" y="84">C</text><text text-anchor="middle" x="288" y="84">C</text><text text-anchor="middle" x="296" y="84">D</text><text text-anchor="middle" x="320" y="84">D</text><text text-anchor="middle" x="328" y="84">C</text><text text-anchor="middle" x="352" y="84">D</text><text text-anchor="middle" x="360" y="84">D</text><text text-anchor="middle" x="16" y="116">A</text><text text-anchor="middle" x="24" y="116">A</text><text text-anchor="middle" x="48" y="116">A</text><text text-anchor="middle" x="56" y="116">B</text><text text-anchor="middle" x="80" y="116">B</text><text text-anchor="middle" x="88" y="116">A</text><text text-anchor="middle" x="112" y="116">B</text><text text-anchor="middle" x="120" y="116">B</text><text text-anchor="middle" x="248" y="116">A</text><text text-anchor="middle" x="256" y="116">A</text><text text-anchor="middle" x="288" y="116">A</text><text text-anchor="middle" x="296" y="116">B</text><text text-anchor="middle" x="320" y="116">B</text><text text-anchor="middle" x="328" y="116">A</text><text text-anchor="middle" x="352" y="116">B</text><text text-anchor="middle" x="360" y="116">B</text><text text-anchor="middle" x="24" y="148">A</text><text text-anchor="middle" x="32" y="148">C</text><text text-anchor="middle" x="56" y="148">A</text><text text-anchor="middle" x="64" y="148">D</text><text text-anchor="middle" x="88" y="148">B</text><text text-anchor="middle" x="96" y="148">C</text><text text-anchor="middle" x="128" y="148">B</text><text text-anchor="middle" x="136" y="148">D</text><text text-anchor="middle" x="248" y="148">A</text><text text-anchor="middle" x="256" y="148">C</text><text text-anchor="middle" x="288" y="148">A</text><text text-anchor="middle" x="296" y="148">D</text><text text-anchor="middle" x="320" y="148">B</text><text text-anchor="middle" x="328" y="148">C</text><text text-anchor="middle" x="352" y="148">B</text><text text-anchor="middle" x="360" y="148">D</text><text text-anchor="middle" x="24" y="164">C</text><text text-anchor="middle" x="32" y="164">A</text><text text-anchor="middle" x="56" y="164">C</text><text text-anchor="middle" x="64" y="164">B</text><text text-anchor="middle" x="88" y="164">D</text><text text-anchor="middle" x="96" y="164">A</text><text text-anchor="middle" x="128" y="164">D</text><text text-anchor="middle" x="136" y="164">B</text><text text-anchor="middle" x="192" y="164">c</text><text text-anchor="middle" x="200" y="164">b</text><text text-anchor="middle" x="248" y="164">C</text><text text-anchor="middle" x="256" y="164">A</text><text text-anchor="middle" x="288" y="164">C</text><text text-anchor="middle" x="296" y="164">B</text><text text-anchor="middle" x="320" y="164">D</text><text text-anchor="middle" x="328" y="164">A</text><text text-anchor="middle" x="352" y="164">D</text><text text-anchor="middle" x="360" y="164">B</text><text text-anchor="middle" x="424" y="164">d</text><text text-anchor="middle" x="432" y="164">a</text><text text-anchor="middle" x="24" y="180">C</text><text text-anchor="middle" x="32" y="180">C</text><text text-anchor="middle" x="56" y="180">C</text><text text-anchor="middle" x="64" y="180">D</text><text text-anchor="middle" x="88" y="180">D</text><text text-anchor="middle" x="96" y="180">C</text><text text-anchor="middle" x="128" y="180">D</text><text text-anchor="middle" x="136" y="180">D</text><text text-anchor="middle" x="248" y="180">C</text><text text-anchor="middle" x="256" y="180">C</text><text text-anchor="middle" x="288" y="180">C</text><text text-anchor="middle" x="296" y="180">D</text><text text-anchor="middle" x="320" y="180">D</text><text text-anchor="middle" x="328" y="180">C</text><text text-anchor="middle" x="352" y="180">D</text><text text-anchor="middle" x="360" y="180">D</text></g></g></svg>

</p><p>

</p><hr>
*

<p></p><p>

This code is slow, but this doesn't matter as it will only be called a constant number of times.

</p><pre class="listing backtick"><code><span class="line"></span>
<span class="line"></span><span class="hljs-comment"># life rule, for a 3x3 collection of cells, where E is the centre</span>
<span class="line"></span><span class="hljs-keyword">def</span> <span class="hljs-title function_">life</span>(<span class="hljs-params">a, b, c, d, E, f, g, h, i</span>):
<span class="line"></span>    outer = <span class="hljs-built_in">sum</span>([t.n <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> [a, b, c, d, f, g, h, i]])
<span class="line"></span>    <span class="hljs-keyword">return</span> on <span class="hljs-keyword">if</span> (E.n <span class="hljs-keyword">and</span> outer == <span class="hljs-number">2</span>) <span class="hljs-keyword">or</span> outer == <span class="hljs-number">3</span> <span class="hljs-keyword">else</span> off
<span class="line"></span>
<span class="line"></span><span class="hljs-keyword">def</span> <span class="hljs-title function_">life_4x4</span>(<span class="hljs-params">m</span>):
<span class="line"></span>    ad = life(m.a.a, m.a.b, m.b.a, m.a.c, m.a.d, m.b.c, m.c.a, m.c.b, m.d.a)  
<span class="line"></span>    bc = life(m.a.b, m.b.a, m.b.b, m.a.d, m.b.c, m.b.d, m.c.b, m.d.a, m.d.b)  
<span class="line"></span>    cb = life(m.a.c, m.a.d, m.b.c, m.c.a, m.c.b, m.d.a, m.c.c, m.c.d, m.d.c)  
<span class="line"></span>    da = life(m.a.d, m.b.c, m.b.d, m.c.b, m.d.a, m.d.b, m.c.d, m.d.c, m.d.d)  
<span class="line"></span>    <span class="hljs-keyword">return</span> join(ab, bc, cb, da)
<span class="line"></span></code></pre><p>


</p><ul>
<li class="asterisk"><strong class="asterisk">successor(node)</strong> return the central successor of a node at time <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-68" style="width: 4.009em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.421em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.231em, 1003.42em, 2.567em, -999.997em); top: -2.294em; left: 0em;"><span class="mrow" id="MathJax-Span-69"><span class="mi" id="MathJax-Span-70" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-71" style="font-family: MathJax_Main; padding-left: 0.216em;">+</span><span class="msubsup" id="MathJax-Span-72" style="padding-left: 0.216em;"><span style="display: inline-block; position: relative; width: 1.872em; height: 0px;"><span style="position: absolute; clip: rect(3.208em, 1000.43em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mn" id="MathJax-Span-73" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.378em; left: 0.483em;"><span class="texatom" id="MathJax-Span-74"><span class="mrow" id="MathJax-Span-75"><span class="mi" id="MathJax-Span-76" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-77" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-78" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.3em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>+</mo><msup><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>2</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-11">t+2^{k-2}</script>, either from the successor cache, or by the recursive rules set out above (caching the result).</li></ul>

<p></p><p>

Assume we have a quadtree, where the children of a node are named ABCD:

</p><p>

<svg class="diagram" xmlns="http://www.w3.org/2000/svg" version="1.1" height="48" width="104" style="margin:0 auto 0 auto;"><g transform="translate(8,16 )">
<g transform="translate(0,0)"><text text-anchor="middle" x="32" y="4">A</text><text text-anchor="middle" x="48" y="4">B</text><text text-anchor="middle" x="32" y="20">C</text><text text-anchor="middle" x="48" y="20">D</text></g></g></svg>

</p><p>

We can split a quadtree node into grandchildren (4×4 grid of grandchildren)

</p><p>

<svg class="diagram" xmlns="http://www.w3.org/2000/svg" version="1.1" height="128" width="216" style="margin:0 auto 0 auto;"><g transform="translate(8,16 )">
<path d="M 40,16 L 40,80 " style="fill:none;"></path>
<path d="M 144,16 L 144,80 " style="fill:none;"></path>
<path d="M 40,16 L 144,16 " style="fill:none;"></path>
<path d="M 40,80 L 144,80 " style="fill:none;"></path>
<g transform="translate(0,0)"><text text-anchor="middle" x="8" y="4">A</text><text text-anchor="middle" x="16" y="4">A</text><text text-anchor="middle" x="56" y="4">A</text><text text-anchor="middle" x="64" y="4">B</text><text text-anchor="middle" x="120" y="4">B</text><text text-anchor="middle" x="128" y="4">A</text><text text-anchor="middle" x="184" y="4">B</text><text text-anchor="middle" x="192" y="4">B</text><text text-anchor="middle" x="8" y="36">A</text><text text-anchor="middle" x="16" y="36">C</text><text text-anchor="middle" x="56" y="36">A</text><text text-anchor="middle" x="64" y="36">D</text><text text-anchor="middle" x="120" y="36">B</text><text text-anchor="middle" x="128" y="36">C</text><text text-anchor="middle" x="184" y="36">B</text><text text-anchor="middle" x="192" y="36">D</text><text text-anchor="middle" x="8" y="68">C</text><text text-anchor="middle" x="16" y="68">A</text><text text-anchor="middle" x="56" y="68">C</text><text text-anchor="middle" x="64" y="68">B</text><text text-anchor="middle" x="120" y="68">D</text><text text-anchor="middle" x="128" y="68">A</text><text text-anchor="middle" x="184" y="68">D</text><text text-anchor="middle" x="192" y="68">B</text><text text-anchor="middle" x="8" y="100">C</text><text text-anchor="middle" x="16" y="100">C</text><text text-anchor="middle" x="56" y="100">C</text><text text-anchor="middle" x="64" y="100">D</text><text text-anchor="middle" x="120" y="100">D</text><text text-anchor="middle" x="128" y="100">C</text><text text-anchor="middle" x="184" y="100">D</text><text text-anchor="middle" x="192" y="100">D</text></g></g></svg>

</p><p>

we want to compute the successor of the central region, that is what will be in:

</p><p>

<svg class="diagram" xmlns="http://www.w3.org/2000/svg" version="1.1" height="48" width="80" style="margin:0 auto 0 auto;"><g transform="translate(8,16 )">
<g transform="translate(0,0)"><text text-anchor="middle" x="16" y="4">a</text><text text-anchor="middle" x="24" y="4">d</text><text text-anchor="middle" x="40" y="4">b</text><text text-anchor="middle" x="48" y="4">c</text><text text-anchor="middle" x="16" y="20">c</text><text text-anchor="middle" x="24" y="20">b</text><text text-anchor="middle" x="40" y="20">d</text><text text-anchor="middle" x="48" y="20">a</text></g></g></svg>

</p><p>

in the future (lowercase to indicate the “successor of”). 

</p><p>

We can further split a node into great grandchildren (8×8 grid of great-grandchildren)

</p><p>

<svg class="diagram" xmlns="http://www.w3.org/2000/svg" version="1.1" height="320" width="544" style="margin:0 auto 0 auto;"><g transform="translate(8,16 )">
<path d="M 96,64 L 96,224 " style="fill:none;"></path>
<path d="M 376,64 L 376,224 " style="fill:none;"></path>
<path d="M 96,64 L 376,64 " style="fill:none;"></path>
<path d="M 96,224 L 376,224 " style="fill:none;"></path>
<g transform="translate(0,0)"><text text-anchor="middle" x="8" y="4">A</text><text text-anchor="middle" x="16" y="4">A</text><text text-anchor="middle" x="24" y="4">A</text><text text-anchor="middle" x="56" y="4">A</text><text text-anchor="middle" x="64" y="4">A</text><text text-anchor="middle" x="72" y="4">B</text><text text-anchor="middle" x="120" y="4">A</text><text text-anchor="middle" x="128" y="4">B</text><text text-anchor="middle" x="136" y="4">A</text><text text-anchor="middle" x="184" y="4">A</text><text text-anchor="middle" x="192" y="4">B</text><text text-anchor="middle" x="200" y="4">B</text><text text-anchor="middle" x="280" y="4">B</text><text text-anchor="middle" x="288" y="4">A</text><text text-anchor="middle" x="296" y="4">A</text><text text-anchor="middle" x="344" y="4">B</text><text text-anchor="middle" x="352" y="4">A</text><text text-anchor="middle" x="360" y="4">B</text><text text-anchor="middle" x="408" y="4">B</text><text text-anchor="middle" x="416" y="4">B</text><text text-anchor="middle" x="424" y="4">A</text><text text-anchor="middle" x="472" y="4">B</text><text text-anchor="middle" x="480" y="4">B</text><text text-anchor="middle" x="488" y="4">B</text><text text-anchor="middle" x="8" y="36">A</text><text text-anchor="middle" x="16" y="36">A</text><text text-anchor="middle" x="24" y="36">C</text><text text-anchor="middle" x="56" y="36">A</text><text text-anchor="middle" x="64" y="36">A</text><text text-anchor="middle" x="72" y="36">D</text><text text-anchor="middle" x="120" y="36">A</text><text text-anchor="middle" x="128" y="36">B</text><text text-anchor="middle" x="136" y="36">C</text><text text-anchor="middle" x="184" y="36">A</text><text text-anchor="middle" x="192" y="36">B</text><text text-anchor="middle" x="200" y="36">D</text><text text-anchor="middle" x="280" y="36">B</text><text text-anchor="middle" x="288" y="36">A</text><text text-anchor="middle" x="296" y="36">C</text><text text-anchor="middle" x="344" y="36">B</text><text text-anchor="middle" x="352" y="36">A</text><text text-anchor="middle" x="360" y="36">D</text><text text-anchor="middle" x="408" y="36">B</text><text text-anchor="middle" x="416" y="36">B</text><text text-anchor="middle" x="424" y="36">C</text><text text-anchor="middle" x="472" y="36">B</text><text text-anchor="middle" x="480" y="36">B</text><text text-anchor="middle" x="488" y="36">D</text><text text-anchor="middle" x="8" y="84">A</text><text text-anchor="middle" x="16" y="84">C</text><text text-anchor="middle" x="24" y="84">A</text><text text-anchor="middle" x="56" y="84">A</text><text text-anchor="middle" x="64" y="84">C</text><text text-anchor="middle" x="72" y="84">B</text><text text-anchor="middle" x="120" y="84">A</text><text text-anchor="middle" x="128" y="84">D</text><text text-anchor="middle" x="136" y="84">A</text><text text-anchor="middle" x="184" y="84">A</text><text text-anchor="middle" x="192" y="84">D</text><text text-anchor="middle" x="200" y="84">B</text><text text-anchor="middle" x="280" y="84">B</text><text text-anchor="middle" x="288" y="84">C</text><text text-anchor="middle" x="296" y="84">A</text><text text-anchor="middle" x="344" y="84">B</text><text text-anchor="middle" x="352" y="84">C</text><text text-anchor="middle" x="360" y="84">B</text><text text-anchor="middle" x="408" y="84">B</text><text text-anchor="middle" x="416" y="84">D</text><text text-anchor="middle" x="424" y="84">A</text><text text-anchor="middle" x="472" y="84">B</text><text text-anchor="middle" x="480" y="84">D</text><text text-anchor="middle" x="488" y="84">B</text><text text-anchor="middle" x="8" y="116">A</text><text text-anchor="middle" x="16" y="116">C</text><text text-anchor="middle" x="24" y="116">C</text><text text-anchor="middle" x="56" y="116">A</text><text text-anchor="middle" x="64" y="116">C</text><text text-anchor="middle" x="72" y="116">D</text><text text-anchor="middle" x="120" y="116">A</text><text text-anchor="middle" x="128" y="116">D</text><text text-anchor="middle" x="136" y="116">C</text><text text-anchor="middle" x="184" y="116">A</text><text text-anchor="middle" x="192" y="116">D</text><text text-anchor="middle" x="200" y="116">D</text><text text-anchor="middle" x="280" y="116">B</text><text text-anchor="middle" x="288" y="116">C</text><text text-anchor="middle" x="296" y="116">C</text><text text-anchor="middle" x="344" y="116">B</text><text text-anchor="middle" x="352" y="116">C</text><text text-anchor="middle" x="360" y="116">D</text><text text-anchor="middle" x="408" y="116">B</text><text text-anchor="middle" x="416" y="116">D</text><text text-anchor="middle" x="424" y="116">C</text><text text-anchor="middle" x="472" y="116">B</text><text text-anchor="middle" x="480" y="116">D</text><text text-anchor="middle" x="488" y="116">D</text><text text-anchor="middle" x="8" y="180">C</text><text text-anchor="middle" x="16" y="180">A</text><text text-anchor="middle" x="24" y="180">A</text><text text-anchor="middle" x="56" y="180">C</text><text text-anchor="middle" x="64" y="180">A</text><text text-anchor="middle" x="72" y="180">B</text><text text-anchor="middle" x="120" y="180">C</text><text text-anchor="middle" x="128" y="180">B</text><text text-anchor="middle" x="136" y="180">A</text><text text-anchor="middle" x="184" y="180">C</text><text text-anchor="middle" x="192" y="180">B</text><text text-anchor="middle" x="200" y="180">B</text><text text-anchor="middle" x="280" y="180">D</text><text text-anchor="middle" x="288" y="180">A</text><text text-anchor="middle" x="296" y="180">A</text><text text-anchor="middle" x="344" y="180">D</text><text text-anchor="middle" x="352" y="180">A</text><text text-anchor="middle" x="360" y="180">B</text><text text-anchor="middle" x="408" y="180">D</text><text text-anchor="middle" x="416" y="180">B</text><text text-anchor="middle" x="424" y="180">A</text><text text-anchor="middle" x="472" y="180">D</text><text text-anchor="middle" x="480" y="180">B</text><text text-anchor="middle" x="488" y="180">B</text><text text-anchor="middle" x="8" y="212">C</text><text text-anchor="middle" x="16" y="212">A</text><text text-anchor="middle" x="24" y="212">C</text><text text-anchor="middle" x="56" y="212">C</text><text text-anchor="middle" x="64" y="212">A</text><text text-anchor="middle" x="72" y="212">D</text><text text-anchor="middle" x="120" y="212">C</text><text text-anchor="middle" x="128" y="212">B</text><text text-anchor="middle" x="136" y="212">C</text><text text-anchor="middle" x="184" y="212">C</text><text text-anchor="middle" x="192" y="212">B</text><text text-anchor="middle" x="200" y="212">D</text><text text-anchor="middle" x="280" y="212">D</text><text text-anchor="middle" x="288" y="212">A</text><text text-anchor="middle" x="296" y="212">C</text><text text-anchor="middle" x="344" y="212">D</text><text text-anchor="middle" x="352" y="212">A</text><text text-anchor="middle" x="360" y="212">D</text><text text-anchor="middle" x="408" y="212">D</text><text text-anchor="middle" x="416" y="212">B</text><text text-anchor="middle" x="424" y="212">C</text><text text-anchor="middle" x="472" y="212">D</text><text text-anchor="middle" x="480" y="212">B</text><text text-anchor="middle" x="488" y="212">D</text><text text-anchor="middle" x="8" y="260">C</text><text text-anchor="middle" x="16" y="260">C</text><text text-anchor="middle" x="24" y="260">A</text><text text-anchor="middle" x="56" y="260">C</text><text text-anchor="middle" x="64" y="260">C</text><text text-anchor="middle" x="72" y="260">B</text><text text-anchor="middle" x="120" y="260">C</text><text text-anchor="middle" x="128" y="260">D</text><text text-anchor="middle" x="136" y="260">A</text><text text-anchor="middle" x="184" y="260">C</text><text text-anchor="middle" x="192" y="260">D</text><text text-anchor="middle" x="200" y="260">B</text><text text-anchor="middle" x="280" y="260">D</text><text text-anchor="middle" x="288" y="260">C</text><text text-anchor="middle" x="296" y="260">A</text><text text-anchor="middle" x="344" y="260">D</text><text text-anchor="middle" x="352" y="260">C</text><text text-anchor="middle" x="360" y="260">B</text><text text-anchor="middle" x="408" y="260">D</text><text text-anchor="middle" x="416" y="260">D</text><text text-anchor="middle" x="424" y="260">A</text><text text-anchor="middle" x="472" y="260">D</text><text text-anchor="middle" x="480" y="260">D</text><text text-anchor="middle" x="488" y="260">B</text><text text-anchor="middle" x="8" y="292">C</text><text text-anchor="middle" x="16" y="292">C</text><text text-anchor="middle" x="24" y="292">C</text><text text-anchor="middle" x="56" y="292">C</text><text text-anchor="middle" x="64" y="292">C</text><text text-anchor="middle" x="72" y="292">D</text><text text-anchor="middle" x="120" y="292">C</text><text text-anchor="middle" x="128" y="292">D</text><text text-anchor="middle" x="136" y="292">C</text><text text-anchor="middle" x="184" y="292">C</text><text text-anchor="middle" x="192" y="292">D</text><text text-anchor="middle" x="200" y="292">D</text><text text-anchor="middle" x="280" y="292">D</text><text text-anchor="middle" x="288" y="292">C</text><text text-anchor="middle" x="296" y="292">C</text><text text-anchor="middle" x="344" y="292">D</text><text text-anchor="middle" x="352" y="292">C</text><text text-anchor="middle" x="360" y="292">D</text><text text-anchor="middle" x="408" y="292">D</text><text text-anchor="middle" x="416" y="292">D</text><text text-anchor="middle" x="424" y="292">C</text><text text-anchor="middle" x="472" y="292">D</text><text text-anchor="middle" x="480" y="292">D</text><text text-anchor="middle" x="488" y="292">D</text></g></g></svg>

</p><p>

Taking for example the <code>[AA AB AC AD]</code> block, we can find the successor
<code>[AAD ABC ACB ADA]</code>, and keep only the result <code>[ADA]</code>, as shown below.

</p><p>

<svg class="diagram" xmlns="http://www.w3.org/2000/svg" version="1.1" height="352" width="544" style="margin:0 auto 0 auto;"><g transform="translate(8,16 )">
<path d="M 104,80 L 104,96 " style="fill:none;"></path>
<path d="M 104,160 L 104,240 " style="fill:none;"></path>
<path d="M 384,80 L 384,240 " style="fill:none;"></path>
<path d="M 104,80 L 160,80 " style="fill:none;"></path>
<path d="M 176,80 L 232,80 " style="fill:none;"></path>
<path d="M 248,80 L 384,80 " style="fill:none;"></path>
<path d="M 104,240 L 384,240 " style="fill:none;"></path>
<g transform="translate(0,0)"><text text-anchor="middle" x="0" y="4">┌</text><text text-anchor="middle" x="8" y="4">─</text><text text-anchor="middle" x="16" y="4">─</text><text text-anchor="middle" x="24" y="4">─</text><text text-anchor="middle" x="32" y="4">─</text><text text-anchor="middle" x="40" y="4">─</text><text text-anchor="middle" x="48" y="4">─</text><text text-anchor="middle" x="56" y="4">─</text><text text-anchor="middle" x="64" y="4">─</text><text text-anchor="middle" x="72" y="4">─</text><text text-anchor="middle" x="80" y="4">─</text><text text-anchor="middle" x="88" y="4">─</text><text text-anchor="middle" x="96" y="4">─</text><text text-anchor="middle" x="104" y="4">─</text><text text-anchor="middle" x="112" y="4">─</text><text text-anchor="middle" x="120" y="4">─</text><text text-anchor="middle" x="128" y="4">─</text><text text-anchor="middle" x="136" y="4">─</text><text text-anchor="middle" x="144" y="4">─</text><text text-anchor="middle" x="152" y="4">─</text><text text-anchor="middle" x="160" y="4">─</text><text text-anchor="middle" x="168" y="4">─</text><text text-anchor="middle" x="176" y="4">─</text><text text-anchor="middle" x="184" y="4">─</text><text text-anchor="middle" x="192" y="4">─</text><text text-anchor="middle" x="200" y="4">─</text><text text-anchor="middle" x="208" y="4">─</text><text text-anchor="middle" x="216" y="4">─</text><text text-anchor="middle" x="224" y="4">─</text><text text-anchor="middle" x="232" y="4">─</text><text text-anchor="middle" x="240" y="4">┐</text><text text-anchor="middle" x="0" y="20">│</text><text text-anchor="middle" x="16" y="20">A</text><text text-anchor="middle" x="24" y="20">A</text><text text-anchor="middle" x="32" y="20">A</text><text text-anchor="middle" x="64" y="20">A</text><text text-anchor="middle" x="72" y="20">A</text><text text-anchor="middle" x="80" y="20">B</text><text text-anchor="middle" x="128" y="20">A</text><text text-anchor="middle" x="136" y="20">B</text><text text-anchor="middle" x="144" y="20">A</text><text text-anchor="middle" x="192" y="20">A</text><text text-anchor="middle" x="200" y="20">B</text><text text-anchor="middle" x="208" y="20">B</text><text text-anchor="middle" x="240" y="20">│</text><text text-anchor="middle" x="288" y="20">B</text><text text-anchor="middle" x="296" y="20">A</text><text text-anchor="middle" x="304" y="20">A</text><text text-anchor="middle" x="352" y="20">B</text><text text-anchor="middle" x="360" y="20">A</text><text text-anchor="middle" x="368" y="20">B</text><text text-anchor="middle" x="416" y="20">B</text><text text-anchor="middle" x="424" y="20">B</text><text text-anchor="middle" x="432" y="20">A</text><text text-anchor="middle" x="480" y="20">B</text><text text-anchor="middle" x="488" y="20">B</text><text text-anchor="middle" x="496" y="20">B</text><text text-anchor="middle" x="0" y="36">│</text><text text-anchor="middle" x="48" y="36">╔</text><text text-anchor="middle" x="56" y="36">═</text><text text-anchor="middle" x="64" y="36">═</text><text text-anchor="middle" x="72" y="36">═</text><text text-anchor="middle" x="80" y="36">═</text><text text-anchor="middle" x="88" y="36">═</text><text text-anchor="middle" x="96" y="36">═</text><text text-anchor="middle" x="104" y="36">═</text><text text-anchor="middle" x="112" y="36">═</text><text text-anchor="middle" x="120" y="36">═</text><text text-anchor="middle" x="128" y="36">═</text><text text-anchor="middle" x="136" y="36">═</text><text text-anchor="middle" x="144" y="36">═</text><text text-anchor="middle" x="152" y="36">═</text><text text-anchor="middle" x="160" y="36">═</text><text text-anchor="middle" x="168" y="36">╗</text><text text-anchor="middle" x="240" y="36">│</text><text text-anchor="middle" x="0" y="52">│</text><text text-anchor="middle" x="16" y="52">A</text><text text-anchor="middle" x="24" y="52">A</text><text text-anchor="middle" x="32" y="52">C</text><text text-anchor="middle" x="48" y="52">║</text><text text-anchor="middle" x="64" y="52">A</text><text text-anchor="middle" x="72" y="52">A</text><text text-anchor="middle" x="80" y="52">D</text><text text-anchor="middle" x="128" y="52">A</text><text text-anchor="middle" x="136" y="52">B</text><text text-anchor="middle" x="144" y="52">C</text><text text-anchor="middle" x="168" y="52">║</text><text text-anchor="middle" x="192" y="52">A</text><text text-anchor="middle" x="200" y="52">B</text><text text-anchor="middle" x="208" y="52">D</text><text text-anchor="middle" x="240" y="52">│</text><text text-anchor="middle" x="288" y="52">B</text><text text-anchor="middle" x="296" y="52">A</text><text text-anchor="middle" x="304" y="52">C</text><text text-anchor="middle" x="352" y="52">B</text><text text-anchor="middle" x="360" y="52">A</text><text text-anchor="middle" x="368" y="52">D</text><text text-anchor="middle" x="416" y="52">B</text><text text-anchor="middle" x="424" y="52">B</text><text text-anchor="middle" x="432" y="52">C</text><text text-anchor="middle" x="480" y="52">B</text><text text-anchor="middle" x="488" y="52">B</text><text text-anchor="middle" x="496" y="52">D</text><text text-anchor="middle" x="0" y="68">│</text><text text-anchor="middle" x="48" y="68">║</text><text text-anchor="middle" x="168" y="68">║</text><text text-anchor="middle" x="240" y="68">│</text><text text-anchor="middle" x="0" y="84">│</text><text text-anchor="middle" x="48" y="84">║</text><text text-anchor="middle" x="168" y="84">║</text><text text-anchor="middle" x="240" y="84">│</text><text text-anchor="middle" x="0" y="100">│</text><text text-anchor="middle" x="16" y="100">A</text><text text-anchor="middle" x="24" y="100">C</text><text text-anchor="middle" x="32" y="100">A</text><text text-anchor="middle" x="48" y="100">║</text><text text-anchor="middle" x="64" y="100">A</text><text text-anchor="middle" x="72" y="100">C</text><text text-anchor="middle" x="80" y="100">B</text><text text-anchor="middle" x="120" y="100">A</text><text text-anchor="middle" x="128" y="100">D</text><text text-anchor="middle" x="136" y="100">A</text><text text-anchor="middle" x="168" y="100">║</text><text text-anchor="middle" x="192" y="100">A</text><text text-anchor="middle" x="200" y="100">D</text><text text-anchor="middle" x="208" y="100">B</text><text text-anchor="middle" x="240" y="100">│</text><text text-anchor="middle" x="288" y="100">B</text><text text-anchor="middle" x="296" y="100">C</text><text text-anchor="middle" x="304" y="100">A</text><text text-anchor="middle" x="352" y="100">B</text><text text-anchor="middle" x="360" y="100">C</text><text text-anchor="middle" x="368" y="100">B</text><text text-anchor="middle" x="416" y="100">B</text><text text-anchor="middle" x="424" y="100">D</text><text text-anchor="middle" x="432" y="100">A</text><text text-anchor="middle" x="480" y="100">B</text><text text-anchor="middle" x="488" y="100">D</text><text text-anchor="middle" x="496" y="100">B</text><text text-anchor="middle" x="0" y="116">│</text><text text-anchor="middle" x="48" y="116">╚</text><text text-anchor="middle" x="56" y="116">═</text><text text-anchor="middle" x="64" y="116">═</text><text text-anchor="middle" x="72" y="116">═</text><text text-anchor="middle" x="80" y="116">═</text><text text-anchor="middle" x="88" y="116">═</text><text text-anchor="middle" x="96" y="116">═</text><text text-anchor="middle" x="104" y="116">═</text><text text-anchor="middle" x="112" y="116">═</text><text text-anchor="middle" x="120" y="116">═</text><text text-anchor="middle" x="128" y="116">═</text><text text-anchor="middle" x="136" y="116">═</text><text text-anchor="middle" x="144" y="116">═</text><text text-anchor="middle" x="152" y="116">═</text><text text-anchor="middle" x="160" y="116">═</text><text text-anchor="middle" x="168" y="116">╝</text><text text-anchor="middle" x="240" y="116">│</text><text text-anchor="middle" x="0" y="132">│</text><text text-anchor="middle" x="16" y="132">A</text><text text-anchor="middle" x="24" y="132">C</text><text text-anchor="middle" x="32" y="132">C</text><text text-anchor="middle" x="64" y="132">A</text><text text-anchor="middle" x="72" y="132">C</text><text text-anchor="middle" x="80" y="132">D</text><text text-anchor="middle" x="104" y="132">|</text><text text-anchor="middle" x="128" y="132">A</text><text text-anchor="middle" x="136" y="132">D</text><text text-anchor="middle" x="144" y="132">C</text><text text-anchor="middle" x="192" y="132">A</text><text text-anchor="middle" x="200" y="132">D</text><text text-anchor="middle" x="208" y="132">D</text><text text-anchor="middle" x="240" y="132">│</text><text text-anchor="middle" x="288" y="132">B</text><text text-anchor="middle" x="296" y="132">C</text><text text-anchor="middle" x="304" y="132">C</text><text text-anchor="middle" x="352" y="132">B</text><text text-anchor="middle" x="360" y="132">C</text><text text-anchor="middle" x="368" y="132">D</text><text text-anchor="middle" x="416" y="132">B</text><text text-anchor="middle" x="424" y="132">D</text><text text-anchor="middle" x="432" y="132">C</text><text text-anchor="middle" x="480" y="132">B</text><text text-anchor="middle" x="488" y="132">D</text><text text-anchor="middle" x="496" y="132">D</text><text text-anchor="middle" x="0" y="148">└</text><text text-anchor="middle" x="8" y="148">─</text><text text-anchor="middle" x="16" y="148">─</text><text text-anchor="middle" x="24" y="148">─</text><text text-anchor="middle" x="32" y="148">─</text><text text-anchor="middle" x="40" y="148">─</text><text text-anchor="middle" x="48" y="148">─</text><text text-anchor="middle" x="56" y="148">─</text><text text-anchor="middle" x="64" y="148">─</text><text text-anchor="middle" x="72" y="148">─</text><text text-anchor="middle" x="80" y="148">─</text><text text-anchor="middle" x="88" y="148">─</text><text text-anchor="middle" x="96" y="148">─</text><text text-anchor="middle" x="104" y="148">─</text><text text-anchor="middle" x="112" y="148">─</text><text text-anchor="middle" x="120" y="148">─</text><text text-anchor="middle" x="128" y="148">─</text><text text-anchor="middle" x="136" y="148">─</text><text text-anchor="middle" x="144" y="148">─</text><text text-anchor="middle" x="152" y="148">─</text><text text-anchor="middle" x="160" y="148">─</text><text text-anchor="middle" x="168" y="148">─</text><text text-anchor="middle" x="176" y="148">─</text><text text-anchor="middle" x="184" y="148">─</text><text text-anchor="middle" x="192" y="148">─</text><text text-anchor="middle" x="200" y="148">─</text><text text-anchor="middle" x="208" y="148">─</text><text text-anchor="middle" x="216" y="148">─</text><text text-anchor="middle" x="224" y="148">─</text><text text-anchor="middle" x="232" y="148">─</text><text text-anchor="middle" x="240" y="148">┘</text><text text-anchor="middle" x="16" y="196">C</text><text text-anchor="middle" x="24" y="196">A</text><text text-anchor="middle" x="32" y="196">A</text><text text-anchor="middle" x="64" y="196">C</text><text text-anchor="middle" x="72" y="196">A</text><text text-anchor="middle" x="80" y="196">B</text><text text-anchor="middle" x="128" y="196">C</text><text text-anchor="middle" x="136" y="196">B</text><text text-anchor="middle" x="144" y="196">A</text><text text-anchor="middle" x="192" y="196">C</text><text text-anchor="middle" x="200" y="196">B</text><text text-anchor="middle" x="208" y="196">B</text><text text-anchor="middle" x="288" y="196">D</text><text text-anchor="middle" x="296" y="196">A</text><text text-anchor="middle" x="304" y="196">A</text><text text-anchor="middle" x="352" y="196">D</text><text text-anchor="middle" x="360" y="196">A</text><text text-anchor="middle" x="368" y="196">B</text><text text-anchor="middle" x="416" y="196">D</text><text text-anchor="middle" x="424" y="196">B</text><text text-anchor="middle" x="432" y="196">A</text><text text-anchor="middle" x="480" y="196">D</text><text text-anchor="middle" x="488" y="196">B</text><text text-anchor="middle" x="496" y="196">B</text><text text-anchor="middle" x="16" y="228">C</text><text text-anchor="middle" x="24" y="228">A</text><text text-anchor="middle" x="32" y="228">C</text><text text-anchor="middle" x="64" y="228">C</text><text text-anchor="middle" x="72" y="228">A</text><text text-anchor="middle" x="80" y="228">D</text><text text-anchor="middle" x="128" y="228">C</text><text text-anchor="middle" x="136" y="228">B</text><text text-anchor="middle" x="144" y="228">C</text><text text-anchor="middle" x="192" y="228">C</text><text text-anchor="middle" x="200" y="228">B</text><text text-anchor="middle" x="208" y="228">D</text><text text-anchor="middle" x="288" y="228">D</text><text text-anchor="middle" x="296" y="228">A</text><text text-anchor="middle" x="304" y="228">C</text><text text-anchor="middle" x="352" y="228">D</text><text text-anchor="middle" x="360" y="228">A</text><text text-anchor="middle" x="368" y="228">D</text><text text-anchor="middle" x="416" y="228">D</text><text text-anchor="middle" x="424" y="228">B</text><text text-anchor="middle" x="432" y="228">C</text><text text-anchor="middle" x="480" y="228">D</text><text text-anchor="middle" x="488" y="228">B</text><text text-anchor="middle" x="496" y="228">D</text><text text-anchor="middle" x="16" y="276">C</text><text text-anchor="middle" x="24" y="276">C</text><text text-anchor="middle" x="32" y="276">A</text><text text-anchor="middle" x="64" y="276">C</text><text text-anchor="middle" x="72" y="276">C</text><text text-anchor="middle" x="80" y="276">B</text><text text-anchor="middle" x="128" y="276">C</text><text text-anchor="middle" x="136" y="276">D</text><text text-anchor="middle" x="144" y="276">A</text><text text-anchor="middle" x="192" y="276">C</text><text text-anchor="middle" x="200" y="276">D</text><text text-anchor="middle" x="208" y="276">B</text><text text-anchor="middle" x="288" y="276">D</text><text text-anchor="middle" x="296" y="276">C</text><text text-anchor="middle" x="304" y="276">A</text><text text-anchor="middle" x="352" y="276">D</text><text text-anchor="middle" x="360" y="276">C</text><text text-anchor="middle" x="368" y="276">B</text><text text-anchor="middle" x="416" y="276">D</text><text text-anchor="middle" x="424" y="276">D</text><text text-anchor="middle" x="432" y="276">A</text><text text-anchor="middle" x="480" y="276">D</text><text text-anchor="middle" x="488" y="276">D</text><text text-anchor="middle" x="496" y="276">B</text><text text-anchor="middle" x="16" y="308">C</text><text text-anchor="middle" x="24" y="308">C</text><text text-anchor="middle" x="32" y="308">C</text><text text-anchor="middle" x="64" y="308">C</text><text text-anchor="middle" x="72" y="308">C</text><text text-anchor="middle" x="80" y="308">D</text><text text-anchor="middle" x="128" y="308">C</text><text text-anchor="middle" x="136" y="308">D</text><text text-anchor="middle" x="144" y="308">C</text><text text-anchor="middle" x="192" y="308">C</text><text text-anchor="middle" x="200" y="308">D</text><text text-anchor="middle" x="208" y="308">D</text><text text-anchor="middle" x="288" y="308">D</text><text text-anchor="middle" x="296" y="308">C</text><text text-anchor="middle" x="304" y="308">C</text><text text-anchor="middle" x="352" y="308">D</text><text text-anchor="middle" x="360" y="308">C</text><text text-anchor="middle" x="368" y="308">D</text><text text-anchor="middle" x="416" y="308">D</text><text text-anchor="middle" x="424" y="308">D</text><text text-anchor="middle" x="432" y="308">C</text><text text-anchor="middle" x="480" y="308">D</text><text text-anchor="middle" x="488" y="308">D</text><text text-anchor="middle" x="496" y="308">D</text></g></g></svg>

</p><p>

Then <code>[AB BA AD BC]</code> to get <code>[ADB BCA]</code>, and so on, scanning across
the interior.

</p><p>

<svg class="diagram" xmlns="http://www.w3.org/2000/svg" version="1.1" height="352" width="544" style="margin:0 auto 0 auto;"><g transform="translate(8,16 )">
<path d="M 104,160 L 104,240 " style="fill:none;"></path>
<path d="M 384,160 L 384,240 " style="fill:none;"></path>
<path d="M 112,80 L 168,80 " style="fill:none;"></path>
<path d="M 184,80 L 312,80 " style="fill:none;"></path>
<path d="M 328,80 L 376,80 " style="fill:none;"></path>
<path d="M 104,240 L 384,240 " style="fill:none;"></path>
<g transform="translate(0,0)"><text text-anchor="middle" x="104" y="4">┌</text><text text-anchor="middle" x="112" y="4">─</text><text text-anchor="middle" x="120" y="4">─</text><text text-anchor="middle" x="128" y="4">─</text><text text-anchor="middle" x="136" y="4">─</text><text text-anchor="middle" x="144" y="4">─</text><text text-anchor="middle" x="152" y="4">─</text><text text-anchor="middle" x="160" y="4">─</text><text text-anchor="middle" x="168" y="4">─</text><text text-anchor="middle" x="176" y="4">─</text><text text-anchor="middle" x="184" y="4">─</text><text text-anchor="middle" x="192" y="4">─</text><text text-anchor="middle" x="200" y="4">─</text><text text-anchor="middle" x="208" y="4">─</text><text text-anchor="middle" x="216" y="4">─</text><text text-anchor="middle" x="224" y="4">─</text><text text-anchor="middle" x="232" y="4">─</text><text text-anchor="middle" x="240" y="4">─</text><text text-anchor="middle" x="248" y="4">─</text><text text-anchor="middle" x="256" y="4">─</text><text text-anchor="middle" x="264" y="4">─</text><text text-anchor="middle" x="272" y="4">─</text><text text-anchor="middle" x="280" y="4">─</text><text text-anchor="middle" x="288" y="4">─</text><text text-anchor="middle" x="296" y="4">─</text><text text-anchor="middle" x="304" y="4">─</text><text text-anchor="middle" x="312" y="4">─</text><text text-anchor="middle" x="320" y="4">─</text><text text-anchor="middle" x="328" y="4">─</text><text text-anchor="middle" x="336" y="4">─</text><text text-anchor="middle" x="344" y="4">─</text><text text-anchor="middle" x="352" y="4">─</text><text text-anchor="middle" x="360" y="4">─</text><text text-anchor="middle" x="368" y="4">─</text><text text-anchor="middle" x="376" y="4">─</text><text text-anchor="middle" x="384" y="4">┐</text><text text-anchor="middle" x="16" y="20">A</text><text text-anchor="middle" x="24" y="20">A</text><text text-anchor="middle" x="32" y="20">A</text><text text-anchor="middle" x="64" y="20">A</text><text text-anchor="middle" x="72" y="20">A</text><text text-anchor="middle" x="80" y="20">B</text><text text-anchor="middle" x="104" y="20">│</text><text text-anchor="middle" x="120" y="20">A</text><text text-anchor="middle" x="128" y="20">B</text><text text-anchor="middle" x="136" y="20">A</text><text text-anchor="middle" x="192" y="20">A</text><text text-anchor="middle" x="200" y="20">B</text><text text-anchor="middle" x="208" y="20">B</text><text text-anchor="middle" x="288" y="20">B</text><text text-anchor="middle" x="296" y="20">A</text><text text-anchor="middle" x="304" y="20">A</text><text text-anchor="middle" x="352" y="20">B</text><text text-anchor="middle" x="360" y="20">A</text><text text-anchor="middle" x="368" y="20">B</text><text text-anchor="middle" x="384" y="20">│</text><text text-anchor="middle" x="416" y="20">B</text><text text-anchor="middle" x="424" y="20">B</text><text text-anchor="middle" x="432" y="20">A</text><text text-anchor="middle" x="480" y="20">B</text><text text-anchor="middle" x="488" y="20">B</text><text text-anchor="middle" x="496" y="20">B</text><text text-anchor="middle" x="104" y="36">│</text><text text-anchor="middle" x="176" y="36">╔</text><text text-anchor="middle" x="184" y="36">═</text><text text-anchor="middle" x="192" y="36">═</text><text text-anchor="middle" x="200" y="36">═</text><text text-anchor="middle" x="208" y="36">═</text><text text-anchor="middle" x="216" y="36">═</text><text text-anchor="middle" x="224" y="36">═</text><text text-anchor="middle" x="232" y="36">═</text><text text-anchor="middle" x="240" y="36">═</text><text text-anchor="middle" x="248" y="36">═</text><text text-anchor="middle" x="256" y="36">═</text><text text-anchor="middle" x="264" y="36">═</text><text text-anchor="middle" x="272" y="36">═</text><text text-anchor="middle" x="280" y="36">═</text><text text-anchor="middle" x="288" y="36">═</text><text text-anchor="middle" x="296" y="36">═</text><text text-anchor="middle" x="304" y="36">═</text><text text-anchor="middle" x="312" y="36">═</text><text text-anchor="middle" x="320" y="36">╗</text><text text-anchor="middle" x="384" y="36">│</text><text text-anchor="middle" x="16" y="52">A</text><text text-anchor="middle" x="24" y="52">A</text><text text-anchor="middle" x="32" y="52">C</text><text text-anchor="middle" x="64" y="52">A</text><text text-anchor="middle" x="72" y="52">A</text><text text-anchor="middle" x="80" y="52">D</text><text text-anchor="middle" x="104" y="52">│</text><text text-anchor="middle" x="120" y="52">A</text><text text-anchor="middle" x="128" y="52">B</text><text text-anchor="middle" x="136" y="52">C</text><text text-anchor="middle" x="176" y="52">║</text><text text-anchor="middle" x="192" y="52">A</text><text text-anchor="middle" x="200" y="52">B</text><text text-anchor="middle" x="208" y="52">D</text><text text-anchor="middle" x="288" y="52">B</text><text text-anchor="middle" x="296" y="52">A</text><text text-anchor="middle" x="304" y="52">C</text><text text-anchor="middle" x="320" y="52">║</text><text text-anchor="middle" x="352" y="52">B</text><text text-anchor="middle" x="360" y="52">A</text><text text-anchor="middle" x="368" y="52">D</text><text text-anchor="middle" x="384" y="52">│</text><text text-anchor="middle" x="416" y="52">B</text><text text-anchor="middle" x="424" y="52">B</text><text text-anchor="middle" x="432" y="52">C</text><text text-anchor="middle" x="480" y="52">B</text><text text-anchor="middle" x="488" y="52">B</text><text text-anchor="middle" x="496" y="52">D</text><text text-anchor="middle" x="104" y="68">│</text><text text-anchor="middle" x="176" y="68">║</text><text text-anchor="middle" x="320" y="68">║</text><text text-anchor="middle" x="384" y="68">│</text><text text-anchor="middle" x="104" y="84">│</text><text text-anchor="middle" x="176" y="84">║</text><text text-anchor="middle" x="320" y="84">║</text><text text-anchor="middle" x="384" y="84">│</text><text text-anchor="middle" x="16" y="100">A</text><text text-anchor="middle" x="24" y="100">C</text><text text-anchor="middle" x="32" y="100">A</text><text text-anchor="middle" x="64" y="100">A</text><text text-anchor="middle" x="72" y="100">C</text><text text-anchor="middle" x="80" y="100">B</text><text text-anchor="middle" x="104" y="100">│</text><text text-anchor="middle" x="120" y="100">A</text><text text-anchor="middle" x="128" y="100">D</text><text text-anchor="middle" x="136" y="100">A</text><text text-anchor="middle" x="176" y="100">║</text><text text-anchor="middle" x="192" y="100">A</text><text text-anchor="middle" x="200" y="100">D</text><text text-anchor="middle" x="208" y="100">B</text><text text-anchor="middle" x="288" y="100">B</text><text text-anchor="middle" x="296" y="100">C</text><text text-anchor="middle" x="304" y="100">A</text><text text-anchor="middle" x="320" y="100">║</text><text text-anchor="middle" x="352" y="100">B</text><text text-anchor="middle" x="360" y="100">C</text><text text-anchor="middle" x="368" y="100">B</text><text text-anchor="middle" x="384" y="100">│</text><text text-anchor="middle" x="416" y="100">B</text><text text-anchor="middle" x="424" y="100">D</text><text text-anchor="middle" x="432" y="100">A</text><text text-anchor="middle" x="480" y="100">B</text><text text-anchor="middle" x="488" y="100">D</text><text text-anchor="middle" x="496" y="100">B</text><text text-anchor="middle" x="104" y="116">│</text><text text-anchor="middle" x="176" y="116">╚</text><text text-anchor="middle" x="184" y="116">═</text><text text-anchor="middle" x="192" y="116">═</text><text text-anchor="middle" x="200" y="116">═</text><text text-anchor="middle" x="208" y="116">═</text><text text-anchor="middle" x="216" y="116">═</text><text text-anchor="middle" x="224" y="116">═</text><text text-anchor="middle" x="232" y="116">═</text><text text-anchor="middle" x="240" y="116">═</text><text text-anchor="middle" x="248" y="116">═</text><text text-anchor="middle" x="256" y="116">═</text><text text-anchor="middle" x="264" y="116">═</text><text text-anchor="middle" x="272" y="116">═</text><text text-anchor="middle" x="280" y="116">═</text><text text-anchor="middle" x="288" y="116">═</text><text text-anchor="middle" x="296" y="116">═</text><text text-anchor="middle" x="304" y="116">═</text><text text-anchor="middle" x="312" y="116">═</text><text text-anchor="middle" x="320" y="116">╝</text><text text-anchor="middle" x="384" y="116">│</text><text text-anchor="middle" x="16" y="132">A</text><text text-anchor="middle" x="24" y="132">C</text><text text-anchor="middle" x="32" y="132">C</text><text text-anchor="middle" x="64" y="132">A</text><text text-anchor="middle" x="72" y="132">C</text><text text-anchor="middle" x="80" y="132">D</text><text text-anchor="middle" x="104" y="132">│</text><text text-anchor="middle" x="120" y="132">A</text><text text-anchor="middle" x="128" y="132">D</text><text text-anchor="middle" x="136" y="132">C</text><text text-anchor="middle" x="192" y="132">A</text><text text-anchor="middle" x="200" y="132">D</text><text text-anchor="middle" x="208" y="132">D</text><text text-anchor="middle" x="288" y="132">B</text><text text-anchor="middle" x="296" y="132">C</text><text text-anchor="middle" x="304" y="132">C</text><text text-anchor="middle" x="352" y="132">B</text><text text-anchor="middle" x="360" y="132">C</text><text text-anchor="middle" x="368" y="132">D</text><text text-anchor="middle" x="384" y="132">|</text><text text-anchor="middle" x="416" y="132">B</text><text text-anchor="middle" x="424" y="132">D</text><text text-anchor="middle" x="432" y="132">C</text><text text-anchor="middle" x="480" y="132">B</text><text text-anchor="middle" x="488" y="132">D</text><text text-anchor="middle" x="496" y="132">D</text><text text-anchor="middle" x="104" y="148">└</text><text text-anchor="middle" x="112" y="148">─</text><text text-anchor="middle" x="120" y="148">─</text><text text-anchor="middle" x="128" y="148">─</text><text text-anchor="middle" x="136" y="148">─</text><text text-anchor="middle" x="144" y="148">─</text><text text-anchor="middle" x="152" y="148">─</text><text text-anchor="middle" x="160" y="148">─</text><text text-anchor="middle" x="168" y="148">─</text><text text-anchor="middle" x="176" y="148">─</text><text text-anchor="middle" x="184" y="148">─</text><text text-anchor="middle" x="192" y="148">─</text><text text-anchor="middle" x="200" y="148">─</text><text text-anchor="middle" x="208" y="148">─</text><text text-anchor="middle" x="216" y="148">─</text><text text-anchor="middle" x="224" y="148">─</text><text text-anchor="middle" x="232" y="148">─</text><text text-anchor="middle" x="240" y="148">─</text><text text-anchor="middle" x="248" y="148">─</text><text text-anchor="middle" x="256" y="148">─</text><text text-anchor="middle" x="264" y="148">─</text><text text-anchor="middle" x="272" y="148">─</text><text text-anchor="middle" x="280" y="148">─</text><text text-anchor="middle" x="288" y="148">─</text><text text-anchor="middle" x="296" y="148">─</text><text text-anchor="middle" x="304" y="148">─</text><text text-anchor="middle" x="312" y="148">─</text><text text-anchor="middle" x="320" y="148">─</text><text text-anchor="middle" x="328" y="148">─</text><text text-anchor="middle" x="336" y="148">─</text><text text-anchor="middle" x="344" y="148">─</text><text text-anchor="middle" x="352" y="148">─</text><text text-anchor="middle" x="360" y="148">─</text><text text-anchor="middle" x="368" y="148">─</text><text text-anchor="middle" x="376" y="148">─</text><text text-anchor="middle" x="384" y="148">┘</text><text text-anchor="middle" x="16" y="196">C</text><text text-anchor="middle" x="24" y="196">A</text><text text-anchor="middle" x="32" y="196">A</text><text text-anchor="middle" x="64" y="196">C</text><text text-anchor="middle" x="72" y="196">A</text><text text-anchor="middle" x="80" y="196">B</text><text text-anchor="middle" x="128" y="196">C</text><text text-anchor="middle" x="136" y="196">B</text><text text-anchor="middle" x="144" y="196">A</text><text text-anchor="middle" x="192" y="196">C</text><text text-anchor="middle" x="200" y="196">B</text><text text-anchor="middle" x="208" y="196">B</text><text text-anchor="middle" x="288" y="196">D</text><text text-anchor="middle" x="296" y="196">A</text><text text-anchor="middle" x="304" y="196">A</text><text text-anchor="middle" x="352" y="196">D</text><text text-anchor="middle" x="360" y="196">A</text><text text-anchor="middle" x="368" y="196">B</text><text text-anchor="middle" x="416" y="196">D</text><text text-anchor="middle" x="424" y="196">B</text><text text-anchor="middle" x="432" y="196">A</text><text text-anchor="middle" x="480" y="196">D</text><text text-anchor="middle" x="488" y="196">B</text><text text-anchor="middle" x="496" y="196">B</text><text text-anchor="middle" x="16" y="228">C</text><text text-anchor="middle" x="24" y="228">A</text><text text-anchor="middle" x="32" y="228">C</text><text text-anchor="middle" x="64" y="228">C</text><text text-anchor="middle" x="72" y="228">A</text><text text-anchor="middle" x="80" y="228">D</text><text text-anchor="middle" x="128" y="228">C</text><text text-anchor="middle" x="136" y="228">B</text><text text-anchor="middle" x="144" y="228">C</text><text text-anchor="middle" x="192" y="228">C</text><text text-anchor="middle" x="200" y="228">B</text><text text-anchor="middle" x="208" y="228">D</text><text text-anchor="middle" x="288" y="228">D</text><text text-anchor="middle" x="296" y="228">A</text><text text-anchor="middle" x="304" y="228">C</text><text text-anchor="middle" x="352" y="228">D</text><text text-anchor="middle" x="360" y="228">A</text><text text-anchor="middle" x="368" y="228">D</text><text text-anchor="middle" x="416" y="228">D</text><text text-anchor="middle" x="424" y="228">B</text><text text-anchor="middle" x="432" y="228">C</text><text text-anchor="middle" x="480" y="228">D</text><text text-anchor="middle" x="488" y="228">B</text><text text-anchor="middle" x="496" y="228">D</text><text text-anchor="middle" x="16" y="276">C</text><text text-anchor="middle" x="24" y="276">C</text><text text-anchor="middle" x="32" y="276">A</text><text text-anchor="middle" x="64" y="276">C</text><text text-anchor="middle" x="72" y="276">C</text><text text-anchor="middle" x="80" y="276">B</text><text text-anchor="middle" x="128" y="276">C</text><text text-anchor="middle" x="136" y="276">D</text><text text-anchor="middle" x="144" y="276">A</text><text text-anchor="middle" x="192" y="276">C</text><text text-anchor="middle" x="200" y="276">D</text><text text-anchor="middle" x="208" y="276">B</text><text text-anchor="middle" x="288" y="276">D</text><text text-anchor="middle" x="296" y="276">C</text><text text-anchor="middle" x="304" y="276">A</text><text text-anchor="middle" x="352" y="276">D</text><text text-anchor="middle" x="360" y="276">C</text><text text-anchor="middle" x="368" y="276">B</text><text text-anchor="middle" x="416" y="276">D</text><text text-anchor="middle" x="424" y="276">D</text><text text-anchor="middle" x="432" y="276">A</text><text text-anchor="middle" x="480" y="276">D</text><text text-anchor="middle" x="488" y="276">D</text><text text-anchor="middle" x="496" y="276">B</text><text text-anchor="middle" x="16" y="308">C</text><text text-anchor="middle" x="24" y="308">C</text><text text-anchor="middle" x="32" y="308">C</text><text text-anchor="middle" x="64" y="308">C</text><text text-anchor="middle" x="72" y="308">C</text><text text-anchor="middle" x="80" y="308">D</text><text text-anchor="middle" x="128" y="308">C</text><text text-anchor="middle" x="136" y="308">D</text><text text-anchor="middle" x="144" y="308">C</text><text text-anchor="middle" x="192" y="308">C</text><text text-anchor="middle" x="200" y="308">D</text><text text-anchor="middle" x="208" y="308">D</text><text text-anchor="middle" x="288" y="308">D</text><text text-anchor="middle" x="296" y="308">C</text><text text-anchor="middle" x="304" y="308">C</text><text text-anchor="middle" x="352" y="308">D</text><text text-anchor="middle" x="360" y="308">C</text><text text-anchor="middle" x="368" y="308">D</text><text text-anchor="middle" x="416" y="308">D</text><text text-anchor="middle" x="424" y="308">D</text><text text-anchor="middle" x="432" y="308">C</text><text text-anchor="middle" x="480" y="308">D</text><text text-anchor="middle" x="488" y="308">D</text><text text-anchor="middle" x="496" y="308">D</text></g></g></svg>

</p><p>

Now we have a way to split up the grandchildren of a node
into nine overlapping child-size blocks so that we can compute successors of the size of the grandchildren. We then subdivide those successor blocks into great-grandchildren
(lowercase indicates successor)

</p><p>

<svg class="diagram" xmlns="http://www.w3.org/2000/svg" version="1.1" height="304" width="544" style="margin:0 auto 0 auto;"><g transform="translate(8,16 )">
<path d="M 112,32 L 112,48 " style="fill:none;"></path>
<path d="M 112,112 L 112,144 " style="fill:none;"></path>
<path d="M 112,208 L 112,224 " style="fill:none;"></path>
<path d="M 464,32 L 464,48 " style="fill:none;"></path>
<path d="M 464,112 L 464,144 " style="fill:none;"></path>
<path d="M 464,208 L 464,224 " style="fill:none;"></path>
<path d="M 48,16 L 64,16 " style="fill:none;"></path>
<path d="M 232,16 L 248,16 " style="fill:none;"></path>
<path d="M 408,16 L 424,16 " style="fill:none;"></path>
<path d="M 112,32 L 136,32 " style="fill:none;"></path>
<path d="M 152,32 L 248,32 " style="fill:none;"></path>
<path d="M 264,32 L 312,32 " style="fill:none;"></path>
<path d="M 328,32 L 424,32 " style="fill:none;"></path>
<path d="M 440,32 L 464,32 " style="fill:none;"></path>
<path d="M 48,112 L 64,112 " style="fill:none;"></path>
<path d="M 232,112 L 248,112 " style="fill:none;"></path>
<path d="M 408,112 L 424,112 " style="fill:none;"></path>
<path d="M 48,208 L 64,208 " style="fill:none;"></path>
<path d="M 232,208 L 248,208 " style="fill:none;"></path>
<path d="M 408,208 L 424,208 " style="fill:none;"></path>
<path d="M 112,224 L 136,224 " style="fill:none;"></path>
<path d="M 152,224 L 248,224 " style="fill:none;"></path>
<path d="M 264,224 L 312,224 " style="fill:none;"></path>
<path d="M 328,224 L 424,224 " style="fill:none;"></path>
<path d="M 440,224 L 464,224 " style="fill:none;"></path>
<polygon points="432,208 420,202.4 420,213.6 " style="stroke:none" transform="rotate(0,424,208 )"></polygon>
<polygon points="432,112 420,106.4 420,117.6 " style="stroke:none" transform="rotate(0,424,112 )"></polygon>
<polygon points="432,16 420,10.4 420,21.6 " style="stroke:none" transform="rotate(0,424,16 )"></polygon>
<polygon points="256,208 244,202.4 244,213.6 " style="stroke:none" transform="rotate(0,248,208 )"></polygon>
<polygon points="256,112 244,106.4 244,117.6 " style="stroke:none" transform="rotate(0,248,112 )"></polygon>
<polygon points="256,16 244,10.4 244,21.6 " style="stroke:none" transform="rotate(0,248,16 )"></polygon>
<polygon points="72,208 60,202.4 60,213.6 " style="stroke:none" transform="rotate(0,64,208 )"></polygon>
<polygon points="72,112 60,106.4 60,117.6 " style="stroke:none" transform="rotate(0,64,112 )"></polygon>
<polygon points="72,16 60,10.4 60,21.6 " style="stroke:none" transform="rotate(0,64,16 )"></polygon>
<g transform="translate(0,0)"><text text-anchor="middle" x="72" y="4">╭</text><text text-anchor="middle" x="80" y="4">1</text><text text-anchor="middle" x="88" y="4">╌</text><text text-anchor="middle" x="96" y="4">╌</text><text text-anchor="middle" x="104" y="4">╌</text><text text-anchor="middle" x="112" y="4">╌</text><text text-anchor="middle" x="120" y="4">╌</text><text text-anchor="middle" x="128" y="4">╌</text><text text-anchor="middle" x="136" y="4">╌</text><text text-anchor="middle" x="144" y="4">╮</text><text text-anchor="middle" x="256" y="4">╭</text><text text-anchor="middle" x="264" y="4">2</text><text text-anchor="middle" x="272" y="4">╌</text><text text-anchor="middle" x="280" y="4">╌</text><text text-anchor="middle" x="288" y="4">╌</text><text text-anchor="middle" x="296" y="4">╌</text><text text-anchor="middle" x="304" y="4">╌</text><text text-anchor="middle" x="312" y="4">╌</text><text text-anchor="middle" x="320" y="4">╮</text><text text-anchor="middle" x="432" y="4">╭</text><text text-anchor="middle" x="440" y="4">3</text><text text-anchor="middle" x="448" y="4">╌</text><text text-anchor="middle" x="456" y="4">╌</text><text text-anchor="middle" x="464" y="4">╌</text><text text-anchor="middle" x="472" y="4">╌</text><text text-anchor="middle" x="480" y="4">╌</text><text text-anchor="middle" x="488" y="4">╌</text><text text-anchor="middle" x="496" y="4">╌</text><text text-anchor="middle" x="504" y="4">╮</text><text text-anchor="middle" x="0" y="20">A</text><text text-anchor="middle" x="8" y="20">A</text><text text-anchor="middle" x="24" y="20">A</text><text text-anchor="middle" x="32" y="20">B</text><text text-anchor="middle" x="72" y="20">╎</text><text text-anchor="middle" x="80" y="20">a</text><text text-anchor="middle" x="88" y="20">a</text><text text-anchor="middle" x="96" y="20">d</text><text text-anchor="middle" x="120" y="20">a</text><text text-anchor="middle" x="128" y="20">b</text><text text-anchor="middle" x="136" y="20">c</text><text text-anchor="middle" x="144" y="20">╎</text><text text-anchor="middle" x="184" y="20">A</text><text text-anchor="middle" x="192" y="20">B</text><text text-anchor="middle" x="208" y="20">B</text><text text-anchor="middle" x="216" y="20">A</text><text text-anchor="middle" x="256" y="20">╎</text><text text-anchor="middle" x="264" y="20">a</text><text text-anchor="middle" x="272" y="20">b</text><text text-anchor="middle" x="280" y="20">d</text><text text-anchor="middle" x="296" y="20">b</text><text text-anchor="middle" x="304" y="20">a</text><text text-anchor="middle" x="312" y="20">c</text><text text-anchor="middle" x="320" y="20">╎</text><text text-anchor="middle" x="352" y="20">B</text><text text-anchor="middle" x="360" y="20">A</text><text text-anchor="middle" x="376" y="20">B</text><text text-anchor="middle" x="384" y="20">B</text><text text-anchor="middle" x="432" y="20">╎</text><text text-anchor="middle" x="440" y="20">b</text><text text-anchor="middle" x="448" y="20">a</text><text text-anchor="middle" x="456" y="20">d</text><text text-anchor="middle" x="480" y="20">b</text><text text-anchor="middle" x="488" y="20">b</text><text text-anchor="middle" x="496" y="20">c</text><text text-anchor="middle" x="504" y="20">╎</text><text text-anchor="middle" x="72" y="36">╎</text><text text-anchor="middle" x="144" y="36">╎</text><text text-anchor="middle" x="256" y="36">╎</text><text text-anchor="middle" x="320" y="36">╎</text><text text-anchor="middle" x="432" y="36">╎</text><text text-anchor="middle" x="504" y="36">╎</text><text text-anchor="middle" x="0" y="52">A</text><text text-anchor="middle" x="8" y="52">C</text><text text-anchor="middle" x="24" y="52">A</text><text text-anchor="middle" x="32" y="52">D</text><text text-anchor="middle" x="72" y="52">╎</text><text text-anchor="middle" x="80" y="52">a</text><text text-anchor="middle" x="88" y="52">c</text><text text-anchor="middle" x="96" y="52">b</text><text text-anchor="middle" x="120" y="52">a</text><text text-anchor="middle" x="128" y="52">d</text><text text-anchor="middle" x="136" y="52">a</text><text text-anchor="middle" x="144" y="52">╎</text><text text-anchor="middle" x="184" y="52">A</text><text text-anchor="middle" x="192" y="52">D</text><text text-anchor="middle" x="208" y="52">B</text><text text-anchor="middle" x="216" y="52">C</text><text text-anchor="middle" x="256" y="52">╎</text><text text-anchor="middle" x="264" y="52">a</text><text text-anchor="middle" x="272" y="52">d</text><text text-anchor="middle" x="280" y="52">b</text><text text-anchor="middle" x="296" y="52">b</text><text text-anchor="middle" x="304" y="52">c</text><text text-anchor="middle" x="312" y="52">a</text><text text-anchor="middle" x="320" y="52">╎</text><text text-anchor="middle" x="352" y="52">B</text><text text-anchor="middle" x="360" y="52">C</text><text text-anchor="middle" x="376" y="52">B</text><text text-anchor="middle" x="384" y="52">D</text><text text-anchor="middle" x="432" y="52">╎</text><text text-anchor="middle" x="440" y="52">b</text><text text-anchor="middle" x="448" y="52">c</text><text text-anchor="middle" x="456" y="52">b</text><text text-anchor="middle" x="480" y="52">b</text><text text-anchor="middle" x="488" y="52">d</text><text text-anchor="middle" x="496" y="52">a</text><text text-anchor="middle" x="504" y="52">╎</text><text text-anchor="middle" x="72" y="68">╰</text><text text-anchor="middle" x="80" y="68">╌</text><text text-anchor="middle" x="88" y="68">╌</text><text text-anchor="middle" x="96" y="68">╌</text><text text-anchor="middle" x="104" y="68">╌</text><text text-anchor="middle" x="112" y="68">╌</text><text text-anchor="middle" x="120" y="68">╌</text><text text-anchor="middle" x="128" y="68">╌</text><text text-anchor="middle" x="136" y="68">╌</text><text text-anchor="middle" x="144" y="68">╯</text><text text-anchor="middle" x="256" y="68">╰</text><text text-anchor="middle" x="264" y="68">╌</text><text text-anchor="middle" x="272" y="68">╌</text><text text-anchor="middle" x="280" y="68">╌</text><text text-anchor="middle" x="288" y="68">╌</text><text text-anchor="middle" x="296" y="68">╌</text><text text-anchor="middle" x="304" y="68">╌</text><text text-anchor="middle" x="312" y="68">╌</text><text text-anchor="middle" x="320" y="68">╯</text><text text-anchor="middle" x="432" y="68">╰</text><text text-anchor="middle" x="440" y="68">╌</text><text text-anchor="middle" x="448" y="68">╌</text><text text-anchor="middle" x="456" y="68">╌</text><text text-anchor="middle" x="464" y="68">╌</text><text text-anchor="middle" x="472" y="68">╌</text><text text-anchor="middle" x="480" y="68">╌</text><text text-anchor="middle" x="488" y="68">╌</text><text text-anchor="middle" x="496" y="68">╌</text><text text-anchor="middle" x="504" y="68">╯</text><text text-anchor="middle" x="112" y="84">|</text><text text-anchor="middle" x="464" y="84">|</text><text text-anchor="middle" x="72" y="100">╭</text><text text-anchor="middle" x="80" y="100">4</text><text text-anchor="middle" x="88" y="100">╌</text><text text-anchor="middle" x="96" y="100">╌</text><text text-anchor="middle" x="104" y="100">╌</text><text text-anchor="middle" x="112" y="100">╌</text><text text-anchor="middle" x="120" y="100">╌</text><text text-anchor="middle" x="128" y="100">╌</text><text text-anchor="middle" x="136" y="100">╌</text><text text-anchor="middle" x="144" y="100">╮</text><text text-anchor="middle" x="256" y="100">╭</text><text text-anchor="middle" x="264" y="100">5</text><text text-anchor="middle" x="272" y="100">╌</text><text text-anchor="middle" x="280" y="100">╌</text><text text-anchor="middle" x="288" y="100">╌</text><text text-anchor="middle" x="296" y="100">╌</text><text text-anchor="middle" x="304" y="100">╌</text><text text-anchor="middle" x="312" y="100">╌</text><text text-anchor="middle" x="320" y="100">╮</text><text text-anchor="middle" x="432" y="100">╭</text><text text-anchor="middle" x="440" y="100">6</text><text text-anchor="middle" x="448" y="100">╌</text><text text-anchor="middle" x="456" y="100">╌</text><text text-anchor="middle" x="464" y="100">╌</text><text text-anchor="middle" x="472" y="100">╌</text><text text-anchor="middle" x="480" y="100">╌</text><text text-anchor="middle" x="488" y="100">╌</text><text text-anchor="middle" x="496" y="100">╌</text><text text-anchor="middle" x="504" y="100">╮</text><text text-anchor="middle" x="0" y="116">A</text><text text-anchor="middle" x="8" y="116">C</text><text text-anchor="middle" x="24" y="116">A</text><text text-anchor="middle" x="32" y="116">D</text><text text-anchor="middle" x="72" y="116">╎</text><text text-anchor="middle" x="80" y="116">a</text><text text-anchor="middle" x="88" y="116">c</text><text text-anchor="middle" x="96" y="116">d</text><text text-anchor="middle" x="120" y="116">a</text><text text-anchor="middle" x="128" y="116">d</text><text text-anchor="middle" x="136" y="116">c</text><text text-anchor="middle" x="144" y="116">╎</text><text text-anchor="middle" x="184" y="116">A</text><text text-anchor="middle" x="192" y="116">D</text><text text-anchor="middle" x="208" y="116">B</text><text text-anchor="middle" x="216" y="116">C</text><text text-anchor="middle" x="256" y="116">╎</text><text text-anchor="middle" x="264" y="116">a</text><text text-anchor="middle" x="272" y="116">d</text><text text-anchor="middle" x="280" y="116">d</text><text text-anchor="middle" x="296" y="116">b</text><text text-anchor="middle" x="304" y="116">c</text><text text-anchor="middle" x="312" y="116">c</text><text text-anchor="middle" x="320" y="116">╎</text><text text-anchor="middle" x="352" y="116">B</text><text text-anchor="middle" x="360" y="116">C</text><text text-anchor="middle" x="376" y="116">B</text><text text-anchor="middle" x="384" y="116">D</text><text text-anchor="middle" x="432" y="116">╎</text><text text-anchor="middle" x="440" y="116">b</text><text text-anchor="middle" x="448" y="116">c</text><text text-anchor="middle" x="456" y="116">d</text><text text-anchor="middle" x="480" y="116">b</text><text text-anchor="middle" x="488" y="116">d</text><text text-anchor="middle" x="496" y="116">c</text><text text-anchor="middle" x="504" y="116">╎</text><text text-anchor="middle" x="72" y="132">╎</text><text text-anchor="middle" x="144" y="132">╎</text><text text-anchor="middle" x="256" y="132">╎</text><text text-anchor="middle" x="320" y="132">╎</text><text text-anchor="middle" x="432" y="132">╎</text><text text-anchor="middle" x="504" y="132">╎</text><text text-anchor="middle" x="0" y="148">C</text><text text-anchor="middle" x="8" y="148">A</text><text text-anchor="middle" x="24" y="148">C</text><text text-anchor="middle" x="32" y="148">B</text><text text-anchor="middle" x="72" y="148">╎</text><text text-anchor="middle" x="80" y="148">c</text><text text-anchor="middle" x="88" y="148">a</text><text text-anchor="middle" x="96" y="148">b</text><text text-anchor="middle" x="120" y="148">c</text><text text-anchor="middle" x="128" y="148">b</text><text text-anchor="middle" x="136" y="148">a</text><text text-anchor="middle" x="144" y="148">╎</text><text text-anchor="middle" x="184" y="148">C</text><text text-anchor="middle" x="192" y="148">B</text><text text-anchor="middle" x="208" y="148">D</text><text text-anchor="middle" x="216" y="148">A</text><text text-anchor="middle" x="256" y="148">╎</text><text text-anchor="middle" x="264" y="148">c</text><text text-anchor="middle" x="272" y="148">b</text><text text-anchor="middle" x="280" y="148">b</text><text text-anchor="middle" x="296" y="148">d</text><text text-anchor="middle" x="304" y="148">a</text><text text-anchor="middle" x="312" y="148">a</text><text text-anchor="middle" x="320" y="148">╎</text><text text-anchor="middle" x="352" y="148">D</text><text text-anchor="middle" x="360" y="148">A</text><text text-anchor="middle" x="376" y="148">D</text><text text-anchor="middle" x="384" y="148">B</text><text text-anchor="middle" x="432" y="148">╎</text><text text-anchor="middle" x="440" y="148">d</text><text text-anchor="middle" x="448" y="148">a</text><text text-anchor="middle" x="456" y="148">b</text><text text-anchor="middle" x="480" y="148">d</text><text text-anchor="middle" x="488" y="148">b</text><text text-anchor="middle" x="496" y="148">a</text><text text-anchor="middle" x="504" y="148">╎</text><text text-anchor="middle" x="72" y="164">╰</text><text text-anchor="middle" x="80" y="164">╌</text><text text-anchor="middle" x="88" y="164">╌</text><text text-anchor="middle" x="96" y="164">╌</text><text text-anchor="middle" x="104" y="164">╌</text><text text-anchor="middle" x="112" y="164">╌</text><text text-anchor="middle" x="120" y="164">╌</text><text text-anchor="middle" x="128" y="164">╌</text><text text-anchor="middle" x="136" y="164">╌</text><text text-anchor="middle" x="144" y="164">╯</text><text text-anchor="middle" x="256" y="164">╰</text><text text-anchor="middle" x="264" y="164">╌</text><text text-anchor="middle" x="272" y="164">╌</text><text text-anchor="middle" x="280" y="164">╌</text><text text-anchor="middle" x="288" y="164">╌</text><text text-anchor="middle" x="296" y="164">╌</text><text text-anchor="middle" x="304" y="164">╌</text><text text-anchor="middle" x="312" y="164">╌</text><text text-anchor="middle" x="320" y="164">╯</text><text text-anchor="middle" x="432" y="164">╰</text><text text-anchor="middle" x="440" y="164">╌</text><text text-anchor="middle" x="448" y="164">╌</text><text text-anchor="middle" x="456" y="164">╌</text><text text-anchor="middle" x="464" y="164">╌</text><text text-anchor="middle" x="472" y="164">╌</text><text text-anchor="middle" x="480" y="164">╌</text><text text-anchor="middle" x="488" y="164">╌</text><text text-anchor="middle" x="496" y="164">╌</text><text text-anchor="middle" x="504" y="164">╯</text><text text-anchor="middle" x="112" y="180">|</text><text text-anchor="middle" x="464" y="180">|</text><text text-anchor="middle" x="72" y="196">╭</text><text text-anchor="middle" x="80" y="196">7</text><text text-anchor="middle" x="88" y="196">╌</text><text text-anchor="middle" x="96" y="196">╌</text><text text-anchor="middle" x="104" y="196">╌</text><text text-anchor="middle" x="112" y="196">╌</text><text text-anchor="middle" x="120" y="196">╌</text><text text-anchor="middle" x="128" y="196">╌</text><text text-anchor="middle" x="136" y="196">╌</text><text text-anchor="middle" x="144" y="196">╮</text><text text-anchor="middle" x="256" y="196">╭</text><text text-anchor="middle" x="264" y="196">8</text><text text-anchor="middle" x="272" y="196">╌</text><text text-anchor="middle" x="280" y="196">╌</text><text text-anchor="middle" x="288" y="196">╌</text><text text-anchor="middle" x="296" y="196">╌</text><text text-anchor="middle" x="304" y="196">╌</text><text text-anchor="middle" x="312" y="196">╌</text><text text-anchor="middle" x="320" y="196">╮</text><text text-anchor="middle" x="432" y="196">╭</text><text text-anchor="middle" x="440" y="196">9</text><text text-anchor="middle" x="448" y="196">╌</text><text text-anchor="middle" x="456" y="196">╌</text><text text-anchor="middle" x="464" y="196">╌</text><text text-anchor="middle" x="472" y="196">╌</text><text text-anchor="middle" x="480" y="196">╌</text><text text-anchor="middle" x="488" y="196">╌</text><text text-anchor="middle" x="496" y="196">╌</text><text text-anchor="middle" x="504" y="196">╮</text><text text-anchor="middle" x="0" y="212">C</text><text text-anchor="middle" x="8" y="212">A</text><text text-anchor="middle" x="24" y="212">C</text><text text-anchor="middle" x="32" y="212">B</text><text text-anchor="middle" x="72" y="212">╎</text><text text-anchor="middle" x="80" y="212">c</text><text text-anchor="middle" x="88" y="212">a</text><text text-anchor="middle" x="96" y="212">d</text><text text-anchor="middle" x="120" y="212">c</text><text text-anchor="middle" x="128" y="212">b</text><text text-anchor="middle" x="136" y="212">c</text><text text-anchor="middle" x="144" y="212">╎</text><text text-anchor="middle" x="184" y="212">C</text><text text-anchor="middle" x="192" y="212">B</text><text text-anchor="middle" x="208" y="212">D</text><text text-anchor="middle" x="216" y="212">A</text><text text-anchor="middle" x="256" y="212">╎</text><text text-anchor="middle" x="264" y="212">c</text><text text-anchor="middle" x="272" y="212">b</text><text text-anchor="middle" x="280" y="212">d</text><text text-anchor="middle" x="296" y="212">d</text><text text-anchor="middle" x="304" y="212">a</text><text text-anchor="middle" x="312" y="212">c</text><text text-anchor="middle" x="320" y="212">╎</text><text text-anchor="middle" x="352" y="212">D</text><text text-anchor="middle" x="360" y="212">A</text><text text-anchor="middle" x="376" y="212">D</text><text text-anchor="middle" x="384" y="212">B</text><text text-anchor="middle" x="432" y="212">╎</text><text text-anchor="middle" x="440" y="212">d</text><text text-anchor="middle" x="448" y="212">a</text><text text-anchor="middle" x="456" y="212">d</text><text text-anchor="middle" x="480" y="212">d</text><text text-anchor="middle" x="488" y="212">b</text><text text-anchor="middle" x="496" y="212">c</text><text text-anchor="middle" x="504" y="212">╎</text><text text-anchor="middle" x="0" y="228">C</text><text text-anchor="middle" x="8" y="228">C</text><text text-anchor="middle" x="24" y="228">C</text><text text-anchor="middle" x="32" y="228">D</text><text text-anchor="middle" x="72" y="228">╎</text><text text-anchor="middle" x="144" y="228">╎</text><text text-anchor="middle" x="256" y="228">╎</text><text text-anchor="middle" x="320" y="228">╎</text><text text-anchor="middle" x="432" y="228">╎</text><text text-anchor="middle" x="504" y="228">╎</text><text text-anchor="middle" x="72" y="244">╎</text><text text-anchor="middle" x="80" y="244">c</text><text text-anchor="middle" x="88" y="244">c</text><text text-anchor="middle" x="96" y="244">b</text><text text-anchor="middle" x="120" y="244">c</text><text text-anchor="middle" x="128" y="244">d</text><text text-anchor="middle" x="136" y="244">a</text><text text-anchor="middle" x="144" y="244">╎</text><text text-anchor="middle" x="184" y="244">C</text><text text-anchor="middle" x="192" y="244">D</text><text text-anchor="middle" x="208" y="244">D</text><text text-anchor="middle" x="216" y="244">C</text><text text-anchor="middle" x="256" y="244">╎</text><text text-anchor="middle" x="264" y="244">c</text><text text-anchor="middle" x="272" y="244">d</text><text text-anchor="middle" x="280" y="244">b</text><text text-anchor="middle" x="296" y="244">d</text><text text-anchor="middle" x="304" y="244">c</text><text text-anchor="middle" x="312" y="244">a</text><text text-anchor="middle" x="320" y="244">╎</text><text text-anchor="middle" x="352" y="244">D</text><text text-anchor="middle" x="360" y="244">C</text><text text-anchor="middle" x="376" y="244">D</text><text text-anchor="middle" x="384" y="244">D</text><text text-anchor="middle" x="432" y="244">╎</text><text text-anchor="middle" x="440" y="244">d</text><text text-anchor="middle" x="448" y="244">c</text><text text-anchor="middle" x="456" y="244">b</text><text text-anchor="middle" x="480" y="244">d</text><text text-anchor="middle" x="488" y="244">d</text><text text-anchor="middle" x="496" y="244">a</text><text text-anchor="middle" x="504" y="244">╎</text><text text-anchor="middle" x="72" y="260">╰</text><text text-anchor="middle" x="80" y="260">╌</text><text text-anchor="middle" x="88" y="260">╌</text><text text-anchor="middle" x="96" y="260">╌</text><text text-anchor="middle" x="104" y="260">╌</text><text text-anchor="middle" x="112" y="260">╌</text><text text-anchor="middle" x="120" y="260">╌</text><text text-anchor="middle" x="128" y="260">╌</text><text text-anchor="middle" x="136" y="260">╌</text><text text-anchor="middle" x="144" y="260">╯</text><text text-anchor="middle" x="256" y="260">╰</text><text text-anchor="middle" x="264" y="260">╌</text><text text-anchor="middle" x="272" y="260">╌</text><text text-anchor="middle" x="280" y="260">╌</text><text text-anchor="middle" x="288" y="260">╌</text><text text-anchor="middle" x="296" y="260">╌</text><text text-anchor="middle" x="304" y="260">╌</text><text text-anchor="middle" x="312" y="260">╌</text><text text-anchor="middle" x="320" y="260">╯</text><text text-anchor="middle" x="432" y="260">╰</text><text text-anchor="middle" x="440" y="260">╌</text><text text-anchor="middle" x="448" y="260">╌</text><text text-anchor="middle" x="456" y="260">╌</text><text text-anchor="middle" x="464" y="260">╌</text><text text-anchor="middle" x="472" y="260">╌</text><text text-anchor="middle" x="480" y="260">╌</text><text text-anchor="middle" x="488" y="260">╌</text><text text-anchor="middle" x="496" y="260">╌</text><text text-anchor="middle" x="504" y="260">╯</text></g></g></svg>

</p><p>

Finally, we can select from those great-grandchildren sized
successor blocks the “inner” parts to make up one full child-sized successor
(a 4×4 block of great-grandchild successors)

</p><p>

<svg class="diagram" xmlns="http://www.w3.org/2000/svg" version="1.1" height="128" width="568" style="margin:0 auto 0 auto;"><g transform="translate(8,16 )">
<path d="M 16,0 L 16,96 " style="fill:none;"></path>
<path d="M 88,8 L 88,40 " style="fill:none;"></path>
<path d="M 88,56 L 88,88 " style="fill:none;"></path>
<path d="M 160,0 L 160,96 " style="fill:none;"></path>
<path d="M 208,0 L 208,96 " style="fill:none;"></path>
<path d="M 352,0 L 352,96 " style="fill:none;"></path>
<path d="M 424,16 L 424,80 " style="fill:none;"></path>
<path d="M 472,16 L 472,80 " style="fill:none;"></path>
<path d="M 528,32 L 528,64 " style="fill:none;"></path>
<path d="M 544,32 L 544,64 " style="fill:none;"></path>
<path d="M 16,0 L 160,0 " style="fill:none;"></path>
<path d="M 208,0 L 352,0 " style="fill:none;"></path>
<path d="M 424,16 L 472,16 " style="fill:none;"></path>
<path d="M 528,32 L 544,32 " style="fill:none;"></path>
<path d="M 24,48 L 152,48 " style="fill:none;"></path>
<path d="M 176,48 L 192,48 " style="fill:none;"></path>
<path d="M 392,48 L 408,48 " style="fill:none;"></path>
<path d="M 496,48 L 512,48 " style="fill:none;"></path>
<path d="M 528,64 L 544,64 " style="fill:none;"></path>
<path d="M 424,80 L 472,80 " style="fill:none;"></path>
<path d="M 16,96 L 160,96 " style="fill:none;"></path>
<path d="M 208,96 L 352,96 " style="fill:none;"></path>
<polygon points="520,48 508,42.4 508,53.6 " style="stroke:none" transform="rotate(0,512,48 )"></polygon>
<polygon points="416,48 404,42.4 404,53.6 " style="stroke:none" transform="rotate(0,408,48 )"></polygon>
<polygon points="200,48 188,42.4 188,53.6 " style="stroke:none" transform="rotate(0,192,48 )"></polygon>
<g transform="translate(0,0)"><text text-anchor="middle" x="24" y="20">1</text><text text-anchor="middle" x="32" y="20">:</text><text text-anchor="middle" x="40" y="20">D</text><text text-anchor="middle" x="56" y="20">2</text><text text-anchor="middle" x="64" y="20">:</text><text text-anchor="middle" x="72" y="20">C</text><text text-anchor="middle" x="104" y="20">2</text><text text-anchor="middle" x="112" y="20">:</text><text text-anchor="middle" x="120" y="20">D</text><text text-anchor="middle" x="136" y="20">3</text><text text-anchor="middle" x="144" y="20">:</text><text text-anchor="middle" x="152" y="20">C</text><text text-anchor="middle" x="216" y="20">a</text><text text-anchor="middle" x="224" y="20">d</text><text text-anchor="middle" x="232" y="20">a</text><text text-anchor="middle" x="248" y="20">a</text><text text-anchor="middle" x="256" y="20">d</text><text text-anchor="middle" x="264" y="20">b</text><text text-anchor="middle" x="280" y="20">╎</text><text text-anchor="middle" x="296" y="20">b</text><text text-anchor="middle" x="304" y="20">c</text><text text-anchor="middle" x="312" y="20">a</text><text text-anchor="middle" x="328" y="20">b</text><text text-anchor="middle" x="336" y="20">c</text><text text-anchor="middle" x="344" y="20">b</text><text text-anchor="middle" x="24" y="36">4</text><text text-anchor="middle" x="32" y="36">:</text><text text-anchor="middle" x="40" y="36">B</text><text text-anchor="middle" x="56" y="36">5</text><text text-anchor="middle" x="64" y="36">:</text><text text-anchor="middle" x="72" y="36">A</text><text text-anchor="middle" x="104" y="36">5</text><text text-anchor="middle" x="112" y="36">:</text><text text-anchor="middle" x="120" y="36">B</text><text text-anchor="middle" x="136" y="36">6</text><text text-anchor="middle" x="144" y="36">:</text><text text-anchor="middle" x="152" y="36">A</text><text text-anchor="middle" x="216" y="36">a</text><text text-anchor="middle" x="224" y="36">d</text><text text-anchor="middle" x="232" y="36">c</text><text text-anchor="middle" x="248" y="36">a</text><text text-anchor="middle" x="256" y="36">d</text><text text-anchor="middle" x="264" y="36">d</text><text text-anchor="middle" x="280" y="36">╎</text><text text-anchor="middle" x="296" y="36">b</text><text text-anchor="middle" x="304" y="36">c</text><text text-anchor="middle" x="312" y="36">c</text><text text-anchor="middle" x="328" y="36">b</text><text text-anchor="middle" x="336" y="36">c</text><text text-anchor="middle" x="344" y="36">d</text><text text-anchor="middle" x="432" y="36">a</text><text text-anchor="middle" x="440" y="36">d</text><text text-anchor="middle" x="456" y="36">b</text><text text-anchor="middle" x="464" y="36">c</text><text text-anchor="middle" x="216" y="52">╌</text><text text-anchor="middle" x="224" y="52">╌</text><text text-anchor="middle" x="232" y="52">╌</text><text text-anchor="middle" x="240" y="52">╌</text><text text-anchor="middle" x="248" y="52">╌</text><text text-anchor="middle" x="256" y="52">╌</text><text text-anchor="middle" x="264" y="52">╌</text><text text-anchor="middle" x="272" y="52">╌</text><text text-anchor="middle" x="280" y="52">╌</text><text text-anchor="middle" x="288" y="52">╌</text><text text-anchor="middle" x="296" y="52">╌</text><text text-anchor="middle" x="304" y="52">╌</text><text text-anchor="middle" x="312" y="52">╌</text><text text-anchor="middle" x="320" y="52">╌</text><text text-anchor="middle" x="328" y="52">╌</text><text text-anchor="middle" x="336" y="52">╌</text><text text-anchor="middle" x="344" y="52">╌</text><text text-anchor="middle" x="536" y="52">N</text><text text-anchor="middle" x="24" y="68">4</text><text text-anchor="middle" x="32" y="68">:</text><text text-anchor="middle" x="40" y="68">D</text><text text-anchor="middle" x="56" y="68">5</text><text text-anchor="middle" x="64" y="68">:</text><text text-anchor="middle" x="72" y="68">C</text><text text-anchor="middle" x="104" y="68">5</text><text text-anchor="middle" x="112" y="68">:</text><text text-anchor="middle" x="120" y="68">D</text><text text-anchor="middle" x="136" y="68">6</text><text text-anchor="middle" x="144" y="68">:</text><text text-anchor="middle" x="152" y="68">C</text><text text-anchor="middle" x="216" y="68">c</text><text text-anchor="middle" x="224" y="68">b</text><text text-anchor="middle" x="232" y="68">a</text><text text-anchor="middle" x="248" y="68">c</text><text text-anchor="middle" x="256" y="68">b</text><text text-anchor="middle" x="264" y="68">b</text><text text-anchor="middle" x="280" y="68">╎</text><text text-anchor="middle" x="296" y="68">d</text><text text-anchor="middle" x="304" y="68">a</text><text text-anchor="middle" x="312" y="68">a</text><text text-anchor="middle" x="328" y="68">d</text><text text-anchor="middle" x="336" y="68">a</text><text text-anchor="middle" x="344" y="68">b</text><text text-anchor="middle" x="432" y="68">c</text><text text-anchor="middle" x="440" y="68">b</text><text text-anchor="middle" x="456" y="68">d</text><text text-anchor="middle" x="464" y="68">a</text><text text-anchor="middle" x="24" y="84">7</text><text text-anchor="middle" x="32" y="84">:</text><text text-anchor="middle" x="40" y="84">B</text><text text-anchor="middle" x="56" y="84">8</text><text text-anchor="middle" x="64" y="84">:</text><text text-anchor="middle" x="72" y="84">A</text><text text-anchor="middle" x="104" y="84">8</text><text text-anchor="middle" x="112" y="84">:</text><text text-anchor="middle" x="120" y="84">B</text><text text-anchor="middle" x="136" y="84">9</text><text text-anchor="middle" x="144" y="84">:</text><text text-anchor="middle" x="152" y="84">A</text><text text-anchor="middle" x="216" y="84">c</text><text text-anchor="middle" x="224" y="84">b</text><text text-anchor="middle" x="232" y="84">c</text><text text-anchor="middle" x="248" y="84">c</text><text text-anchor="middle" x="256" y="84">b</text><text text-anchor="middle" x="264" y="84">d</text><text text-anchor="middle" x="280" y="84">╎</text><text text-anchor="middle" x="296" y="84">d</text><text text-anchor="middle" x="304" y="84">a</text><text text-anchor="middle" x="312" y="84">c</text><text text-anchor="middle" x="328" y="84">d</text><text text-anchor="middle" x="336" y="84">a</text><text text-anchor="middle" x="344" y="84">d</text></g></g></svg>

</p><p>

To compute a node advanced one generation ahead, we could apply the rule given above directly:

</p><pre class="listing backtick"><code><span class="line"></span><span class="hljs-meta">@lru_cache(<span class="hljs-params">maxsize=<span class="hljs-number">2</span>**<span class="hljs-number">20</span></span>)</span>
<span class="line"></span><span class="hljs-keyword">def</span> <span class="hljs-title function_">next_gen</span>(<span class="hljs-params">m</span>):
<span class="line"></span>    <span class="hljs-string">"""Return the 2**k-1 x 2**k-1 successor, 1 generation forward"""</span>    
<span class="line"></span>    <span class="hljs-keyword">if</span> m.n==<span class="hljs-number">0</span>: <span class="hljs-comment"># empty</span>
<span class="line"></span>        <span class="hljs-keyword">return</span> m.a    
<span class="line"></span>    <span class="hljs-keyword">elif</span> m.k == <span class="hljs-number">2</span>:  <span class="hljs-comment"># base case               </span>
<span class="line"></span>        s = life_4x4(m)    
<span class="line"></span>    <span class="hljs-keyword">else</span>:
<span class="line"></span>        c1 = next_gen(join(m.a.a, m.a.b, m.a.c, m.a.d))
<span class="line"></span>        c2 = next_gen(join(m.a.b, m.b.a, m.a.d, m.b.c))
<span class="line"></span>        c3 = next_gen(join(m.b.a, m.b.b, m.b.c, m.b.d))
<span class="line"></span>        c4 = next_gen(join(m.a.c, m.a.d, m.c.a, m.c.b))        
<span class="line"></span>        c5 = next_gen(join(m.a.d, m.b.c, m.c.b, m.d.a))
<span class="line"></span>        c6 = next_gen(join(m.b.c, m.b.d, m.d.a, m.d.b))
<span class="line"></span>        c7 = next_gen(join(m.c.a, m.c.b, m.c.c, m.c.d))
<span class="line"></span>        c8 = next_gen(join(m.c.b, m.d.a, m.c.d, m.d.c))
<span class="line"></span>        c9 = next_gen(join(m.d.a, m.d.b, m.d.c, m.d.d))
<span class="line"></span>        
<span class="line"></span>        s = join(
<span class="line"></span>            (join(c1.d, c2.c, c4.b, c5.a)),
<span class="line"></span>            (join(c2.d, c3.c, c5.b, c6.a)),
<span class="line"></span>            (join(c4.d, c5.c, c7.b, c8.a)),
<span class="line"></span>            (join(c5.d, c6.c, c8.b, c9.a)),
<span class="line"></span>        )                    
<span class="line"></span>    <span class="hljs-keyword">return</span> s</code></pre><p>
However, this doesn't give exponential speed-ups in time. The true Hashlife algorithm computes <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-79" style="width: 2.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.872em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(-0.051em, 1001.87em, 1.178em, -999.997em); top: -1.012em; left: 0em;"><span class="mrow" id="MathJax-Span-80"><span class="msubsup" id="MathJax-Span-81"><span style="display: inline-block; position: relative; width: 1.872em; height: 0px;"><span style="position: absolute; clip: rect(3.208em, 1000.43em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mn" id="MathJax-Span-82" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.378em; left: 0.483em;"><span class="texatom" id="MathJax-Span-83"><span class="mrow" id="MathJax-Span-84"><span class="mi" id="MathJax-Span-85" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-86" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-87" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.018em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>2</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-12">2^{k-2}</script> steps into the future for a level <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-88" style="width: 0.644em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.537em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.124em, 1000.54em, 2.139em, -999.997em); top: -1.974em; left: 0em;"><span class="mrow" id="MathJax-Span-89"><span class="mi" id="MathJax-Span-90" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 1.979em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">k</script> input. The code to do <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-91" style="width: 2.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.872em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(-0.051em, 1001.87em, 1.178em, -999.997em); top: -1.012em; left: 0em;"><span class="mrow" id="MathJax-Span-92"><span class="msubsup" id="MathJax-Span-93"><span style="display: inline-block; position: relative; width: 1.872em; height: 0px;"><span style="position: absolute; clip: rect(3.208em, 1000.43em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mn" id="MathJax-Span-94" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.378em; left: 0.483em;"><span class="texatom" id="MathJax-Span-95"><span class="mrow" id="MathJax-Span-96"><span class="mi" id="MathJax-Span-97" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-98" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-99" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.018em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>2</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-14">2^{k-2}</script> steps is almost the same but has a double recursion:

</p><pre class="listing backtick"><code><span class="line"></span><span class="hljs-meta">@lru_cache(<span class="hljs-params">maxsize=<span class="hljs-number">2</span>**<span class="hljs-number">24</span></span>)</span>
<span class="line"></span><span class="hljs-keyword">def</span> <span class="hljs-title function_">successor</span>(<span class="hljs-params">m</span>):    
<span class="line"></span>    <span class="hljs-string">"""Return the 2**k-1 x 2**k-1 successor, 2**k-2 generations forward"""</span>    
<span class="line"></span>    <span class="hljs-keyword">if</span> m.n==<span class="hljs-number">0</span>: <span class="hljs-comment"># empty</span>
<span class="line"></span>        <span class="hljs-keyword">return</span> m.a    
<span class="line"></span>    <span class="hljs-keyword">elif</span> m.k == <span class="hljs-number">2</span>:  <span class="hljs-comment"># base case               </span>
<span class="line"></span>        s = life_4x4(m)    
<span class="line"></span>    <span class="hljs-keyword">else</span>:
<span class="line"></span>        c1 = successor(join(m.a.a, m.a.b, m.a.c, m.a.d))
<span class="line"></span>        c2 = successor(join(m.a.b, m.b.a, m.a.d, m.b.c))
<span class="line"></span>        c3 = successor(join(m.b.a, m.b.b, m.b.c, m.b.d))
<span class="line"></span>        c4 = successor(join(m.a.c, m.a.d, m.c.a, m.c.b))        
<span class="line"></span>        c5 = successor(join(m.a.d, m.b.c, m.c.b, m.d.a))
<span class="line"></span>        c6 = successor(join(m.b.c, m.b.d, m.d.a, m.d.b))
<span class="line"></span>        c7 = successor(join(m.c.a, m.c.b, m.c.c, m.c.d))
<span class="line"></span>        c8 = successor(join(m.c.b, m.d.a, m.c.d, m.d.c))
<span class="line"></span>        c9 = successor(join(m.d.a, m.d.b, m.d.c, m.d.d))
<span class="line"></span>
<span class="line"></span>        <span class="hljs-comment"># recurse again, inside each sub-element</span>
<span class="line"></span>        s = join(
<span class="line"></span>            successor(join(c1, c2, c4, c5)),
<span class="line"></span>            successor(join(c2, c3, c5, c6)),
<span class="line"></span>            successor(join(c4, c5, c7, c8)),
<span class="line"></span>            successor(join(c5, c6, c8, c9)),
<span class="line"></span>        )   
<span class="line"></span>    <span class="hljs-keyword">return</span> s</code></pre><p>

However, if we wanted to compute some smaller jump forward than <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-100" style="width: 2.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.872em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(-0.051em, 1001.87em, 1.178em, -999.997em); top: -1.012em; left: 0em;"><span class="mrow" id="MathJax-Span-101"><span class="msubsup" id="MathJax-Span-102"><span style="display: inline-block; position: relative; width: 1.872em; height: 0px;"><span style="position: absolute; clip: rect(3.208em, 1000.43em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mn" id="MathJax-Span-103" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.378em; left: 0.483em;"><span class="texatom" id="MathJax-Span-104"><span class="mrow" id="MathJax-Span-105"><span class="mi" id="MathJax-Span-106" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-107" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-108" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.018em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>2</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-15">2^{k-2}</script>, there is no way to do so directly. Adding a parameter <code>j</code> allows a skip by any power of 2 smaller or equal to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-109" style="width: 2.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.872em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(-0.051em, 1001.87em, 1.178em, -999.997em); top: -1.012em; left: 0em;"><span class="mrow" id="MathJax-Span-110"><span class="msubsup" id="MathJax-Span-111"><span style="display: inline-block; position: relative; width: 1.872em; height: 0px;"><span style="position: absolute; clip: rect(3.208em, 1000.43em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mn" id="MathJax-Span-112" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.378em; left: 0.483em;"><span class="texatom" id="MathJax-Span-113"><span class="mrow" id="MathJax-Span-114"><span class="mi" id="MathJax-Span-115" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-116" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-117" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.018em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>2</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-16">2^{k-2}</script>, to give our final implementation.

</p><pre class="listing backtick"><code><span class="line"></span><span class="hljs-meta">@lru_cache(<span class="hljs-params">maxsize=<span class="hljs-number">2</span> ** <span class="hljs-number">24</span></span>)</span>
<span class="line"></span><span class="hljs-keyword">def</span> <span class="hljs-title function_">successor</span>(<span class="hljs-params">m, j=<span class="hljs-literal">None</span></span>):
<span class="line"></span>    <span class="hljs-string">"""Return the 2**k-1 x 2**k-1 successor, 2**j generations in the future"""</span>
<span class="line"></span>    <span class="hljs-keyword">if</span> m.n == <span class="hljs-number">0</span>:  <span class="hljs-comment"># empty</span>
<span class="line"></span>        <span class="hljs-keyword">return</span> m.a
<span class="line"></span>    <span class="hljs-keyword">elif</span> m.k == <span class="hljs-number">2</span>:  <span class="hljs-comment"># base case</span>
<span class="line"></span>        s = life_4x4(m)
<span class="line"></span>    <span class="hljs-keyword">else</span>:
<span class="line"></span>        j = m.k - <span class="hljs-number">2</span> <span class="hljs-keyword">if</span> j <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">else</span> <span class="hljs-built_in">min</span>(j, m.k - <span class="hljs-number">2</span>)
<span class="line"></span>        c1 = successor(join(m.a.a, m.a.b, m.a.c, m.a.d), j)
<span class="line"></span>        c2 = successor(join(m.a.b, m.b.a, m.a.d, m.b.c), j)
<span class="line"></span>        c3 = successor(join(m.b.a, m.b.b, m.b.c, m.b.d), j)
<span class="line"></span>        c4 = successor(join(m.a.c, m.a.d, m.c.a, m.c.b), j)
<span class="line"></span>        c5 = successor(join(m.a.d, m.b.c, m.c.b, m.d.a), j)
<span class="line"></span>        c6 = successor(join(m.b.c, m.b.d, m.d.a, m.d.b), j)
<span class="line"></span>        c7 = successor(join(m.c.a, m.c.b, m.c.c, m.c.d), j)
<span class="line"></span>        c8 = successor(join(m.c.b, m.d.a, m.c.d, m.d.c), j)
<span class="line"></span>        c9 = successor(join(m.d.a, m.d.b, m.d.c, m.d.d), j)
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">if</span> j &lt; m.k - <span class="hljs-number">2</span>:
<span class="line"></span>            s = join(
<span class="line"></span>                (join(c1.d, c2.c, c4.b, c5.a)),
<span class="line"></span>                (join(c2.d, c3.c, c5.b, c6.a)),
<span class="line"></span>                (join(c4.d, c5.c, c7.b, c8.a)),
<span class="line"></span>                (join(c5.d, c6.c, c8.b, c9.a)),
<span class="line"></span>            )
<span class="line"></span>        <span class="hljs-keyword">else</span>:
<span class="line"></span>            s = join(
<span class="line"></span>                successor(join(c1, c2, c4, c5), j),
<span class="line"></span>                successor(join(c2, c3, c5, c6), j),
<span class="line"></span>                successor(join(c4, c5, c7, c8), j),
<span class="line"></span>                successor(join(c5, c6, c8, c9), j),
<span class="line"></span>            )
<span class="line"></span>    <span class="hljs-keyword">return</span> s</code></pre><p>

</p><hr>

<p></p><p>

That's it! That's all the essential code to implement Hashlife. There are some utilities we need to be able to work with this quadtree.

</p>
<a class="target" name="utilities">&nbsp;</a><a class="target" name="inpython/utilities">&nbsp;</a><a class="target" name="toc2.3">&nbsp;</a><h2>Utilities</h2>

<a class="target" name="advancingtime">&nbsp;</a><a class="target" name="inpython/utilities/advancingtime">&nbsp;</a><a class="target" name="toc2.3.1">&nbsp;</a><h3>Advancing time</h3>
<p>



</p><ul>
<li class="asterisk"><strong class="asterisk">advance(node, n)</strong> find the <code>n</code>th successor of a given node. Since we compute any advance step of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-118" style="width: 1.018em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.857em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(0.003em, 1000.86em, 1.178em, -999.997em); top: -1.012em; left: 0em;"><span class="mrow" id="MathJax-Span-119"><span class="msubsup" id="MathJax-Span-120"><span style="display: inline-block; position: relative; width: 0.857em; height: 0px;"><span style="position: absolute; clip: rect(3.208em, 1000.43em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mn" id="MathJax-Span-121" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.378em; left: 0.483em;"><span class="mi" id="MathJax-Span-122" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.018em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mi>j</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-17">2^j</script>, up to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-123" style="width: 2.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.872em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(-0.051em, 1001.87em, 1.178em, -999.997em); top: -1.012em; left: 0em;"><span class="mrow" id="MathJax-Span-124"><span class="msubsup" id="MathJax-Span-125"><span style="display: inline-block; position: relative; width: 1.872em; height: 0px;"><span style="position: absolute; clip: rect(3.208em, 1000.43em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mn" id="MathJax-Span-126" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.378em; left: 0.483em;"><span class="texatom" id="MathJax-Span-127"><span class="mrow" id="MathJax-Span-128"><span class="mi" id="MathJax-Span-129" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-130" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-131" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.018em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>2</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-18">2^{k-2}</script>, of a level <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-132" style="width: 0.644em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.537em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.124em, 1000.54em, 2.139em, -999.997em); top: -1.974em; left: 0em;"><span class="mrow" id="MathJax-Span-133"><span class="mi" id="MathJax-Span-134" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 1.979em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">k</script> node, we can advance by any <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-135" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.59em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.392em, 1000.59em, 2.139em, -999.997em); top: -1.974em; left: 0em;"><span class="mrow" id="MathJax-Span-136"><span class="mi" id="MathJax-Span-137" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 1.979em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-20">n</script> by using the binary expansion of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-138" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.59em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.392em, 1000.59em, 2.139em, -999.997em); top: -1.974em; left: 0em;"><span class="mrow" id="MathJax-Span-139"><span class="mi" id="MathJax-Span-140" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 1.979em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-21">n</script> to find the successor. We first pad the node with zeros so that we can a jump at least <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-141" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.59em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.392em, 1000.59em, 2.139em, -999.997em); top: -1.974em; left: 0em;"><span class="mrow" id="MathJax-Span-142"><span class="mi" id="MathJax-Span-143" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 1.979em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">n</script> steps ahead.</li></ul>

<p></p><pre class="listing backtick"><code><span class="line"></span><span class="hljs-keyword">def</span> <span class="hljs-title function_">advance</span>(<span class="hljs-params">node, n</span>):        
<span class="line"></span>    <span class="hljs-keyword">if</span> n==<span class="hljs-number">0</span>:
<span class="line"></span>        <span class="hljs-keyword">return</span> node    
<span class="line"></span>    
<span class="line"></span>    <span class="hljs-comment"># get binary expansion and make sure we've padded enough</span>
<span class="line"></span>    bits = []    
<span class="line"></span>    <span class="hljs-keyword">while</span> n &gt; <span class="hljs-number">0</span>:
<span class="line"></span>        bits.append(n &amp; <span class="hljs-number">1</span>)
<span class="line"></span>        n = n &gt;&gt; <span class="hljs-number">1</span>
<span class="line"></span>        node = centre(node) <span class="hljs-comment"># nest        </span>
<span class="line"></span>    
<span class="line"></span>    <span class="hljs-keyword">for</span> k, bit <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(<span class="hljs-built_in">reversed</span>(bits)):
<span class="line"></span>        j = <span class="hljs-built_in">len</span>(bits) - k  - <span class="hljs-number">1</span>        
<span class="line"></span>        <span class="hljs-keyword">if</span> bit:
<span class="line"></span>            node = successor(node, j)
<span class="line"></span>    <span class="hljs-keyword">return</span> node</code></pre><p>


</p><ul>
<li class="asterisk"><strong class="asterisk">ffwd(node, n)</strong> if we just want to simulate as fast as possible, we can use <code>ffwd</code> to jump forward as quickly as possible:</li></ul>

<p></p><pre class="listing backtick"><code><span class="line"></span><span class="hljs-keyword">def</span> <span class="hljs-title function_">ffwd</span>(<span class="hljs-params">node, n</span>):    
<span class="line"></span>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):       
<span class="line"></span>        <span class="hljs-keyword">while</span> (node.k &lt; <span class="hljs-number">3</span> <span class="hljs-keyword">or</span> node.a.n != node.a.d.d.n <span class="hljs-keyword">or</span>
<span class="line"></span>                node.b.n != node.b.c.c.n <span class="hljs-keyword">or</span>
<span class="line"></span>                node.c.n != node.c.b.b.n <span class="hljs-keyword">or</span>
<span class="line"></span>                node.d.n != node.d.a.a.n):
<span class="line"></span>                node = centre(node)    
<span class="line"></span>        node = successor(node)
<span class="line"></span>    <span class="hljs-keyword">return</span> node</code></pre>
<a class="target" name="packing/unpacking">&nbsp;</a><a class="target" name="inpython/utilities/packing/unpacking">&nbsp;</a><a class="target" name="toc2.3.2">&nbsp;</a><h3>Packing/unpacking</h3>
<p>


We need to be able to pack and unpack data to/from quadtree format. <code>expand</code> and <code>construct</code> can transform nodes to/from <code>(x,y)</code> point lists.

</p><p>

</p><ul>
<li class="asterisk"><strong class="asterisk">expand(node, clip=None, level=0)</strong> transform a quadtree into a list of (x,y) cell coordinates that fall inside a given clipping window (e.g. for display). <code>level</code> allows us to report the average occupancy of quadtree leaves without fully recursing into them.</li></ul>

<p></p><pre class="listing backtick"><code><span class="line"></span><span class="hljs-keyword">def</span> <span class="hljs-title function_">expand</span>(<span class="hljs-params">node, x=<span class="hljs-number">0</span>, y=<span class="hljs-number">0</span>, clip=<span class="hljs-literal">None</span>, level=<span class="hljs-number">0</span></span>):
<span class="line"></span>    <span class="hljs-string">"""Turn a quadtree a list of (x,y,gray) triples 
<span class="line"></span>    in the rectangle (x,y) -&gt; (clip[0], clip[1]) (if clip is not-None).    
<span class="line"></span>    If `level` is given, quadtree elements at the given level are given 
<span class="line"></span>    as a grayscale level 0.0-&gt;1.0,  "zooming out" the display."""</span>
<span class="line"></span>    
<span class="line"></span>    <span class="hljs-keyword">if</span> node.n==<span class="hljs-number">0</span>: <span class="hljs-comment"># quick zero check</span>
<span class="line"></span>        <span class="hljs-keyword">return</span> []    
<span class="line"></span>
<span class="line"></span>    size = <span class="hljs-number">2</span> ** node.k
<span class="line"></span>    <span class="hljs-comment"># bounds check</span>
<span class="line"></span>    <span class="hljs-keyword">if</span> clip <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:
<span class="line"></span>        <span class="hljs-keyword">if</span> x + size &lt; clip[<span class="hljs-number">0</span>] <span class="hljs-keyword">or</span> x &gt; clip[<span class="hljs-number">1</span>] <span class="hljs-keyword">or</span> 
<span class="line"></span>           y + size &lt; clip[<span class="hljs-number">2</span>] <span class="hljs-keyword">or</span> y &gt; clip[<span class="hljs-number">3</span>]:
<span class="line"></span>            <span class="hljs-keyword">return</span> []
<span class="line"></span>
<span class="line"></span>    <span class="hljs-keyword">if</span> node.k == level:
<span class="line"></span>        <span class="hljs-comment"># base case: return the gray level of this node</span>
<span class="line"></span>        gray = node.n / (size ** <span class="hljs-number">2</span>)
<span class="line"></span>        <span class="hljs-keyword">return</span> [(x &gt;&gt; level, y &gt;&gt; level, gray)]
<span class="line"></span>
<span class="line"></span>    <span class="hljs-keyword">else</span>:
<span class="line"></span>        <span class="hljs-comment"># return all points contained inside this node</span>
<span class="line"></span>        offset = size &gt;&gt; <span class="hljs-number">1</span>
<span class="line"></span>        <span class="hljs-keyword">return</span> (
<span class="line"></span>            expand(node.a, x, y, clip, level)
<span class="line"></span>            + expand(node.b, x + offset, y, clip, level)
<span class="line"></span>            + expand(node.c, x, y + offset, clip, level)
<span class="line"></span>            + expand(node.d, x + offset, y + offset, clip, level)
<span class="line"></span>        )       </code></pre><p>


</p><ul>
<li class="asterisk"><strong class="asterisk">construct(cells)</strong> convert a set of (x,y) coordinates into a quadtree node by recursively merging blocks together.</li></ul>

<p></p><pre class="listing backtick"><code><span class="line"></span><span class="hljs-keyword">def</span> <span class="hljs-title function_">construct</span>(<span class="hljs-params">pts</span>):
<span class="line"></span>    <span class="hljs-string">"""Turn a list of (x,y) coordinates into a quadtree"""</span>
<span class="line"></span>    <span class="hljs-comment"># Force start at (0,0)</span>
<span class="line"></span>    min_x = <span class="hljs-built_in">min</span>(*[x <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> pts])
<span class="line"></span>    min_y = <span class="hljs-built_in">min</span>(*[y <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> pts])
<span class="line"></span>    pattern = {(x - min_x, y - min_y): on <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> pts}
<span class="line"></span>    k = <span class="hljs-number">0</span>
<span class="line"></span>
<span class="line"></span>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(pattern) != <span class="hljs-number">1</span>:
<span class="line"></span>        <span class="hljs-comment"># bottom-up construction</span>
<span class="line"></span>        next_level = {}
<span class="line"></span>        z = get_zero(k)
<span class="line"></span>
<span class="line"></span>        <span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(pattern) &gt; <span class="hljs-number">0</span>:
<span class="line"></span>            x, y = <span class="hljs-built_in">next</span>(<span class="hljs-built_in">iter</span>(pattern))
<span class="line"></span>            x, y = x - (x &amp; <span class="hljs-number">1</span>), y - (y &amp; <span class="hljs-number">1</span>)
<span class="line"></span>            <span class="hljs-comment"># read all 2x2 neighbours, removing from those to work through</span>
<span class="line"></span>            <span class="hljs-comment"># at least one of these must exist by definition</span>
<span class="line"></span>            a = pattern.pop((x, y), z)
<span class="line"></span>            b = pattern.pop((x + <span class="hljs-number">1</span>, y), z)
<span class="line"></span>            c = pattern.pop((x, y + <span class="hljs-number">1</span>), z)
<span class="line"></span>            d = pattern.pop((x + <span class="hljs-number">1</span>, y + <span class="hljs-number">1</span>), z)
<span class="line"></span>            next_level[x &gt;&gt; <span class="hljs-number">1</span>, y &gt;&gt; <span class="hljs-number">1</span>] = join(a, b, c, d)
<span class="line"></span>
<span class="line"></span>        <span class="hljs-comment"># merge at the next level</span>
<span class="line"></span>        pattern = next_level
<span class="line"></span>        k += <span class="hljs-number">1</span>
<span class="line"></span>    <span class="hljs-keyword">return</span> pattern.popitem()[<span class="hljs-number">1</span>]</code></pre>
<a class="target" name="testing">&nbsp;</a><a class="target" name="inpython/testing">&nbsp;</a><a class="target" name="toc2.4">&nbsp;</a><h2>Testing</h2>
<p>


Using some utility functions from <code>lifeparsers.py</code> to load standard Life patten formats, we can verify that this works:

</p><pre class="listing backtick"><code><span class="line"></span>    <span class="hljs-keyword">from</span> lifeparsers <span class="hljs-keyword">import</span> autoguess_life_file
<span class="line"></span>
<span class="line"></span>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">load_lif</span>(<span class="hljs-params">fname</span>):
<span class="line"></span>        pat, comments = autoguess_life_file(fname)
<span class="line"></span>        <span class="hljs-keyword">return</span> construct(pat)</code></pre><pre class="listing backtick"><code><span class="line"></span>    &gt;&gt;&gt; ffwd(load_lif(<span class="hljs-string">"lifep/breeder.lif"</span>), <span class="hljs-number">64</span>)
<span class="line"></span>    (Node k=<span class="hljs-number">74</span>, <span class="hljs-number">18889465931478580854784</span> x <span class="hljs-number">18889465931478580854784</span>, population <span class="hljs-number">464598858302721315414285904656952238927788</span>, <span class="hljs-number">18889465931478580853760</span>)</code></pre><p>

This took 1139ms (!) to compute 18,889,465,931,478,580,853,760 generations of the <a href="https://conwaylife.com/wiki/Breeder_1">original breeder</a> on my machine. We can inspect the caches:

</p><pre class="listing backtick"><code><span class="line"></span>    &gt;&gt;&gt; successor.cache_info()
<span class="line"></span>    CacheInfo(hits=<span class="hljs-number">673144</span>, misses=<span class="hljs-number">66334</span>, maxsize=<span class="hljs-number">16777216</span>, currsize=<span class="hljs-number">66334</span>)</code></pre><pre class="listing backtick"><code><span class="line"></span>    &gt;&gt;&gt; join.cache_info()
<span class="line"></span>    CacheInfo(hits=<span class="hljs-number">744684</span>, misses=<span class="hljs-number">66358</span>, maxsize=<span class="hljs-number">16777216</span>, currsize=<span class="hljs-number">66358</span>)</code></pre><p>

We can check it is doing the right thing for smaller steps, too:

</p><pre class="listing backtick"><code><span class="line"></span>pat = centre(centre(load_lif(<span class="hljs-string">"lifep/gun30.lif"</span>)))
<span class="line"></span>render_img(expand(pat))
<span class="line"></span>render_img(expand(advance(pat), <span class="hljs-number">30</span>)))
<span class="line"></span>render_img(expand(advance(pat), <span class="hljs-number">120</span>)))</code></pre><p>

<table width="100%"><tbody><tr valign="top"><td>

<p></p><p>

</p><center><div class="image" style=""><a href="./index.md_files/gun30_0.png" target="_blank"><img class="markdeep" src="./index.md_files/gun30_0.png"></a><center><span class="imagecaption">Glider gun, t=0</span></center></div></center>

<p></p><p>

</p></td></tr><tr valign="top"><td>

<p></p><p>

</p><center><div class="image" style=""><a href="./index.md_files/gun30_30.png" target="_blank"><img class="markdeep" src="./index.md_files/gun30_30.png"></a><center><span class="imagecaption">Glider gun, t=30</span></center></div></center>

<p></p><p>

</p></td></tr><tr valign="top"><td>

<p></p><p>

</p><center><div class="image" style=""><a href="./index.md_files/gun30_120_0.png" target="_blank"><img class="markdeep" src="./index.md_files/gun30_120_0.png"></a><center><span class="imagecaption">Glider gun, t=120</span></center></div></center>

<p></p><p>

</p></td></tr></tbody></table>

</p><p>

And test out the “zoom out” functionality, rendering higher levels of the quadtree:

</p><pre class="listing backtick"><code><span class="line"></span>render_img(expand(advance(pat), <span class="hljs-number">120</span>), level=<span class="hljs-number">0</span>))
<span class="line"></span>render_img(expand(advance(pat), <span class="hljs-number">120</span>), level=<span class="hljs-number">1</span>))
<span class="line"></span>render_img(expand(advance(pat), <span class="hljs-number">30</span>), level=<span class="hljs-number">2</span>))
<span class="line"></span>render_img(expand(advance(pat), <span class="hljs-number">120</span>), level=<span class="hljs-number">3</span>))</code></pre><p>

<table width="100%"><tbody><tr valign="top"><td>

<p></p><p>

</p><center><div class="image" style=""><a href="./index.md_files/gun30_120_0.png" target="_blank"><img class="markdeep" src="./index.md_files/gun30_120_0.png"></a><center><span class="imagecaption">Glider gun, t=120, level=0</span></center></div></center>

<p></p><p>

</p></td></tr><tr valign="top"><td>

<p></p><p>

</p><center><div class="image" style=""><a href="./index.md_files/gun30_120_1.png" target="_blank"><img class="markdeep" src="./index.md_files/gun30_120_1.png" width="50%"></a><center><span class="imagecaption">Glider gun, t=120, level=1</span></center></div></center>

<p></p><p>

</p></td></tr><tr valign="top"><td>

<p></p><p>

</p><center><div class="image" style=""><a href="./index.md_files/gun30_120_2.png" target="_blank"><img class="markdeep" src="./index.md_files/gun30_120_2.png" width="25%"></a><center><span class="imagecaption">Glider gun, t=120, level=2</span></center></div></center>

<p></p><p>

</p></td></tr><tr valign="top"><td>

<p></p><p>

</p><center><div class="image" style=""><a href="./index.md_files/gun30_120_3.png" target="_blank"><img class="markdeep" src="./index.md_files/gun30_120_3.png" width="13%"></a><center><span class="imagecaption">Glider gun, t=120, level=3</span></center></div></center>

<p></p><p>

</p></td></tr></tbody></table>

</p>
<a class="target" name="references">&nbsp;</a><a class="target" name="inpython/references">&nbsp;</a><a class="target" name="toc2.5">&nbsp;</a><h2>References</h2>
<p>

</p><div class="bib">[<a class="target" name="citation-gosper1984">&nbsp;</a><b>Gosper1984</b>] Gosper, Bill (1984). “Exploiting Regularities in Large Cellular Spaces”. Physica D. Elsevier. 10 (1–2): 75–80. doi:10.1016/0167-2789(84)90251-3.
</div>

<p></p><p>

<a href="https://johnhw.github.io/">John H Williamson</a>

</p><p>

<a href="https://github.com/johnhw">GitHub</a> / <a href="https://twitter.com/jhnhw">@jhnhw</a>

</p><p>

<link rel="stylesheet" href="./index.md_files/style.css" type="text/css">
<script>
window.markdeepOptions = {tocStyle:'none'};</script>
</p></span><div id="mdContextMenu" style="visibility:hidden"></div><div class="markdeepFooter"><i>formatted by <a href="https://casual-effects.com/markdeep" style="color:#999">Markdeep&nbsp;1.16&nbsp;&nbsp;</a></i><div style="display:inline-block;font-size:13px;font-family:&#39;Times New Roman&#39;,serif;vertical-align:middle;transform:translate(-3px,-1px)rotate(135deg);">✒</div></div><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; min-width: 0px; max-width: none; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Main, sans-serif;"></div></div></body><style>
@media print {
  #simplifyJobsContainer {
    display: none;
  }
}
</style><div id="simplifyJobsContainer" style="position: absolute; top: 0px; left: 0px; width: 0px; height: 0px; overflow: visible; z-index: 2147483647;"><span><template shadowrootmode="open"><link rel="stylesheet" href="chrome-extension://pbanhockgagggenencehbnadejlgchfc/css/styles.css"><style>
  :host {
    all: initial;
    line-height: 1.5;
    -webkit-text-size-adjust: 100%;
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
    font-family: Palanquin, ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
  }
  * {
    font-family: Palanquin, ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
    scrollbar-width: thin;
    scrollbar-color: rgba(203, 213, 225, 1) transparent;
  }
  *::-webkit-scrollbar {
    width: 6px;
  }
  *::-webkit-scrollbar-track {
    background: transparent;
  }
  *::-webkit-scrollbar-thumb {
    background-color: rgba(203, 213, 225, 1);
    border-radius: 3px;
    border: 0;
  }
</style><div id="simplifyJobsPortals"></div></template></span></div><script id="simplifyJobsPageScript" src="chrome-extension://pbanhockgagggenencehbnadejlgchfc/js/pageScript.bundle.js"></script></html>